{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Bautista\\\\Documents\\\\Proyectos\\\\bayTours\\\\bayTours\\\\frontend_2.0\\\\baytours-react\\\\src\\\\pages\\\\GroupDetail.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Button, Container, Row, Col, Tab, Nav, Spinner } from 'react-bootstrap';\nimport { useParams, useLocation, Link, useNavigate } from 'react-router-dom';\n\n// Importamos nuestros nuevos componentes refactorizados\nimport InfoGeneral from '../components/GroupDetail/InfoGeneral';\nimport ItinerarySection from '../components/GroupDetail/ItinerarySection';\nimport ContactSection from '../components/GroupDetail/ContactSection';\n\n// Componentes principales para mostrar datos\nimport ClientsTable from '../components/ClientsTable';\nimport OptionalsSection from '../components/OptionalsSection';\nimport OptionalsFilterModal from '../components/OptionalsFilterModal';\nimport HotelAssignmentsTable from '../components/HotelAssignmentsTable'; // Placeholder para asignaciones de hoteles\nimport HotelModal from '../components/GroupDetail/modals/HotelModal';\n// Importamos el modal para agregar otro hotel (HotelAddAnotherModal.jsx)\nimport HotelAddAnotherModal from '../components/GroupDetail/modals/HotelAddAnotherModal';\nimport HotelFilterModal from '../components/GroupDetail/modals/HotelFilterModal';\n\n// Importar los modales para los cuartos \nimport RoomsTable from '../components/GroupDetail/RoomsTable';\nimport CitySubMenu from '../components/GroupDetail/CitySubmenu';\nimport RoomAssignmentModal from '../components/GroupDetail/modals/RoomAssignmentModal';\nimport RoomFilterModal from '../components/GroupDetail/modals/RoomFilterModal';\n\n// Modales para edición de información general\nimport EditGuideModal from '../components/GroupDetail/modals/EditGuideModal';\nimport EditBusModal from '../components/GroupDetail/modals/EditBusModal';\nimport EditQRModal from '../components/GroupDetail/modals/EditQRModal';\n\n// Importar los nuevos modales\nimport EditOperationsAgentModal from '../components/GroupDetail/modals/EditOperationsAgentModal';\nimport EditAssistantModal from '../components/GroupDetail/modals/EditAssistantModal';\nimport EditResponsibleHotelsModal from '../components/GroupDetail/modals/EditResponsibleHotelsModal';\n\n// Importar modales para opcionales (Add, Edit y Delete)\nimport AddOptionalModal from '../components/GroupDetail/modals/AddOptionalModal';\nimport EditOptionalModal from '../components/GroupDetail/modals/EditOptionalModal';\nimport DeleteOptionalModal from '../components/GroupDetail/modals/DeleteOptionalModal';\nimport OptionModal from '../components/GroupDetail/modals/OptionModal';\n// ... otros modales que necesites\n\nimport 'leaflet/dist/leaflet.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GroupDetail = () => {\n  _s();\n  var _currentOptionParams$, _currentOptionParams$2, _currentOptionParams$3;\n  const {\n    id\n  } = useParams();\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  // Extraer parámetros de la query string: tabla activa y filtros\n  const queryParams = new URLSearchParams(location.search);\n  const initialTable = queryParams.get('table') || 'clientes';\n  const filters = queryParams.get('filters') || null;\n\n  // --- Estados locales ---\n\n  // Estado de la pestaña activa (por defecto, la que viene en la URL)\n  const [activeTab, setActiveTab] = useState(initialTable);\n\n  // Estado para mostrar el modal de filtro (aplica a la tabla activa)\n  const [showFilterModal, setShowFilterModal] = useState(false);\n\n  // Estados para almacenar los datos del grupo\n  const [groupData, setGroupData] = useState(null);\n  const [tableData, setTableData] = useState([]);\n  const [itinerary, setItinerary] = useState([]);\n  const [clientAges, setClientAges] = useState({});\n  const [loading, setLoading] = useState(true);\n\n  // Estados para modales de información general\n  const [showEditGuideModal, setShowEditGuideModal] = useState(false);\n  const [showEditBusModal, setShowEditBusModal] = useState(false);\n  const [showEditQRModal, setShowEditQRModal] = useState(false);\n\n  // Estados para modales de contacto\n  const [showEditOperationsAgentModal, setShowEditOperationsAgentModal] = useState(false);\n  const [showEditAssistantModal, setShowEditAssistantModal] = useState(false);\n  const [showEditResponsibleHotelsModal, setShowEditResponsibleHotelsModal] = useState(false);\n  // Estados para modales de opcionales\n  const [showAddOptionalModal, setShowAddOptionalModal] = useState(false);\n  const [showEditOptionalModal, setShowEditOptionalModal] = useState(false);\n  const [showDeleteOptionalModal, setShowDeleteOptionalModal] = useState(false);\n  const [currentOptionalData, setCurrentOptionalData] = useState(null);\n\n  // Datos para el modal de opcionales (cliente y día seleccionados)\n  const [optionalClientData, setOptionalClientData] = useState({\n    clientId: '',\n    city: '',\n    cityDays: [],\n    clientName: '',\n    dayId: ''\n  });\n  const [showOptionModal, setShowOptionModal] = useState(false);\n  const [currentOptionParams, setCurrentOptionParams] = useState({\n    client: null,\n    dayId: '',\n    city: '',\n    cityDays: []\n  });\n\n  // Estado para el modal de hoteles\n  const [showHotelModal, setShowHotelModal] = useState(false);\n  const [hotelInitialData, setHotelInitialData] = useState(null);\n\n  // Estado para el modal de agregar otro hotel para el mismo día (nuevo)\n  const [showHotelAddAnotherModal, setShowHotelAddAnotherModal] = useState(false);\n  const [hotelAddAnotherInitialData, setHotelAddAnotherInitialData] = useState({});\n  const [showHotelFilterModal, setShowHotelFilterModal] = useState(false);\n\n  // Estados para la sección de cuartos\n  const [dayOptions, setDayOptions] = useState({});\n  const [selectedCity, setSelectedCity] = useState('');\n  const [roomAssignments, setRoomAssignments] = useState([]);\n  const [showRoomModal, setShowRoomModal] = useState(false);\n  const [roomModalData, setRoomModalData] = useState(null);\n  const [availableHotels, setAvailableHotels] = useState([]);\n  const [availableCity, setAvailableCity] = useState([]);\n  const [availableRooms, setAvailableRooms] = useState([]);\n\n  // --- Función para obtener datos del grupo ---\n  const fetchGroupData = useCallback(() => {\n    const apiUrl = `${process.env.REACT_APP_API_URL}/groups/group_data`;\n    // Se envía la pestaña activa (clientes, hoteles, etc.) en la variable \"table\"\n    const params = new URLSearchParams({\n      id_group: id,\n      table: activeTab\n    });\n    if (filters) {\n      params.append('filters', filters);\n    }\n    fetch(`${apiUrl}?${params.toString()}`).then(response => {\n      if (!response.ok) throw new Error('Error al obtener los datos del grupo');\n      return response.json();\n    }).then(data => {\n      setGroupData(data.group_data);\n      setTableData(data.table_data);\n      setItinerary(data.itinerary || []);\n      setClientAges(data.client_ages || {});\n    }).catch(error => console.error('Error al obtener el detalle del grupo:', error)).finally(() => setLoading(false));\n  }, [id, activeTab, filters]);\n\n  // Actualizar datos cada vez que cambie el id, la pestaña activa o los filtros\n  useEffect(() => {\n    setLoading(true);\n    fetchGroupData();\n  }, [fetchGroupData]);\n\n  // --- Callbacks para manejar modales de opcionales ---\n  // Función para obtener las opciones de días (submenú de ciudades)\n  const fetchDayOptions = () => {\n    fetch(`${process.env.REACT_APP_API_URL}/days/get_day_id?id_group=${groupData.id_group}`).then(res => res.json()).then(data => {\n      setDayOptions(data);\n      // Si no hay ciudad seleccionada, elegir la primera clave\n      const cities = Object.keys(data);\n      if (cities.length > 0 && !selectedCity) {\n        setSelectedCity(cities[0]);\n      }\n    }).catch(err => console.error('Error al obtener opciones de días:', err));\n  };\n\n  // Función para obtener asignaciones de cuartos según id_days\n  const fetchRoomAssignments = () => {\n    if (selectedCity && dayOptions[selectedCity]) {\n      const id_days = dayOptions[selectedCity]; // Esto es un array de strings\n      fetch(`${process.env.REACT_APP_API_URL}/rooms/`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(id_days)\n      }).then(res => res.json()).then(data => {\n        if (Array.isArray(data)) {\n          setRoomAssignments(data);\n        }\n      }).catch(err => console.error('Error al obtener asignaciones de cuartos:', err));\n    }\n  };\n  useEffect(() => {\n    if (groupData) {\n      fetchDayOptions();\n    }\n  }, [groupData]);\n  useEffect(() => {\n    // Cada vez que cambia la ciudad seleccionada, actualizamos la tabla de cuartos\n    if (selectedCity) {\n      fetchRoomAssignments();\n    }\n  }, [selectedCity, dayOptions]);\n  const handleEditRoom = assignment => {\n    // Función para convertir la fecha de \"DD/MM\" a \"YYYY-MM-DD\"\n    const formatDateToISO = (dateStr, year) => {\n      const [day, month] = dateStr.split('/');\n      return `${year}-${month}-${day}`;\n    };\n\n    // Supongamos que assignment.date tiene el formato \"DD/MM\" y necesitas agregar el año\n    const year = new Date().getFullYear(); // Puedes ajustar esto según sea necesario\n    const formattedDate = formatDateToISO(assignment.date, year);\n\n    // Asumiendo que assignment tiene, entre otros, \"city\" y \"date\"\n    // Llama al endpoint para obtener los hoteles disponibles para esa ciudad y fecha\n    fetch(`${process.env.REACT_APP_API_URL}/hotels_reservation/get_by_group_and_date?id_group=${groupData.id_group}&date_day=${formattedDate}`).then(res => res.json()).then(data => {\n      if (Array.isArray(data)) {\n        setAvailableHotels(data);\n      } else {\n        setAvailableHotels([]);\n      }\n    }).catch(err => {\n      console.error('Error al obtener hoteles disponibles:', err);\n      setAvailableHotels([]);\n    });\n    setRoomModalData(assignment);\n    setShowRoomModal(true);\n    fetch(`${process.env.REACT_APP_API_URL}/rooms/city?id_days=${roomModalData.id_days}`).then(res => res.json()).then(data => {\n      console.log('Ciudades disponibles:', data);\n      setAvailableCity(data);\n    }).catch(err => console.error('Error al obtener Ciudades disponibles:', err));\n    fetch(`${process.env.REACT_APP_API_URL}/rooms/room?id_days=${roomModalData.id_days}`).then(res => res.json()).then(data => {\n      console.log('Habitaciones disponibles:', data);\n      setAvailableRooms(data);\n    }).catch(err => console.error('Error al obtener Hbitaciones disponibles:', err));\n  };\n\n  // Abre el modal intermedio de opciones (Editar, Agregar, Borrar) para un cliente en un día específico\n  const handleOptionModal = (client, dayId, cityInfo, cityDays, optional = null) => {\n    setCurrentOptionParams({\n      client,\n      dayId,\n      city: cityInfo.city,\n      cityDays\n    });\n    // Si el cliente ya tiene opcionales para ese día, preselecciona el primero\n    if (optional) {\n      setCurrentOptionalData(optional);\n    } else if (client.day_optionals && client.day_optionals[dayId] && client.day_optionals[dayId].length > 0) {\n      setCurrentOptionalData(client.day_optionals[dayId][0]);\n    } else {\n      setCurrentOptionalData(null);\n    }\n    setShowOptionModal(true);\n  };\n\n  // Acción \"Agregar\" desde el modal de opciones\n  const handleOptionModalAdd = () => {\n    setOptionalClientData({\n      clientId: currentOptionParams.client.id_clients,\n      city: currentOptionParams.city,\n      cityDays: currentOptionParams.cityDays,\n      clientName: `${currentOptionParams.client.first_name} ${currentOptionParams.client.paternal_surname}`,\n      dayId: currentOptionParams.dayId\n    });\n    setShowAddOptionalModal(true);\n  };\n\n  // Acción \"Editar\" desde el modal de opciones\n  const handleOptionModalEdit = () => {\n    if (currentOptionalData) {\n      setShowEditOptionalModal(true);\n    } else {\n      alert('No hay opcionales para editar en este día.');\n    }\n  };\n\n  // Acción \"Borrar\" desde el modal de opciones\n  const handleOptionModalDelete = () => {\n    setCurrentOptionalData(currentOptionalData);\n    setShowDeleteOptionalModal(true);\n  };\n\n  // Función para manejar la acción directa \"Agregar\" (sin pasar por el modal intermedio)\n  const handleAddOptional = (client, dayId, city, cityDays) => {\n    setOptionalClientData({\n      clientId: client.id_clients,\n      city,\n      cityDays,\n      clientName: `${client.first_name} ${client.paternal_surname}`,\n      dayId\n    });\n    setShowAddOptionalModal(true);\n  };\n\n  // Función para manejar la acción directa \"Editar\" de un opcional\n  const handleEditOptional = (client, dayId, optional) => {\n    const cityFound = itinerary.find(ci => ci.days.some(d => d.id === dayId));\n    const newOptionalClientData = {\n      clientId: client.id_clients,\n      city: cityFound ? cityFound.city : '',\n      cityDays: cityFound ? cityFound.days : [],\n      clientName: `${client.first_name} ${client.paternal_surname}`,\n      dayId\n    };\n    setOptionalClientData(newOptionalClientData);\n    setCurrentOptionParams({\n      ...newOptionalClientData,\n      client\n    });\n    setCurrentOptionalData(optional);\n    setShowEditOptionalModal(true);\n  };\n\n  // Callback para aplicar filtros desde el modal de filtro\n  const handleApplyFilter = filtersObj => {\n    const filtersParam = encodeURIComponent(JSON.stringify(filtersObj));\n    navigate(`/grupo/${groupData.id_group}?table=${activeTab}&filters=${filtersParam}`);\n  };\n  const handleApplyHotelFilters = filters => {\n    const filtersParam = encodeURIComponent(JSON.stringify(filters));\n    navigate(`/grupo/${groupData.id_group}?table=hoteles&filters=${filtersParam}`);\n  };\n\n  // Ejemplo de callback para abrir el modal de agregar otro hotel:\n  const handleOpenHotelAddAnother = assignmentData => {\n    console.log('Datos de la asignación actual:', assignmentData);\n    // Si el modal no está abierto, reiniciamos; de lo contrario, acumulamos\n    setHotelAddAnotherInitialData(prev => {\n      if (!showHotelAddAnotherModal) {\n        return {\n          city: assignmentData.city,\n          date: assignmentData.date,\n          id_group: groupData.id_group,\n          new_pax: Number(assignmentData.new_pax || 0),\n          id_day: assignmentData.id_day\n        };\n      } else {\n        return {\n          city: assignmentData.city,\n          date: assignmentData.date,\n          id_group: groupData.id_group,\n          new_pax: Number(assignmentData.paxAssigned || 0),\n          id_day: assignmentData.id_day\n        };\n      }\n    });\n    // O, alternativamente, forzar el reinicio cuando se cierra el modal\n    setShowHotelAddAnotherModal(true);\n  };\n  const handleCloseHotelAddAnother = () => {\n    setShowHotelAddAnotherModal(false);\n    setHotelAddAnotherInitialData({});\n  };\n\n  // --- Renderizado de la interfaz ---\n\n  // Mientras se cargan los datos, se muestra un spinner\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"text-center py-5\",\n      children: /*#__PURE__*/_jsxDEV(Spinner, {\n        animation: \"border\",\n        role: \"status\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"visually-hidden\",\n          children: \"Cargando...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 379,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 377,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Si no se encontró el grupo, se muestra un mensaje de error\n  if (!groupData) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Error: Grupo no encontrado.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 23\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 387,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Container, {\n    fluid: true,\n    children: [/*#__PURE__*/_jsxDEV(Row, {\n      className: \"mt-1\",\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        className: \"text-center\",\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"mt-1 mb-1\",\n          children: [groupData.id_group, \": \", groupData.nombre_circuito]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      className: \"mt-3\",\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        md: 3,\n        children: /*#__PURE__*/_jsxDEV(InfoGeneral, {\n          groupData: groupData,\n          onEditGuide: () => {\n            setShowEditGuideModal(true);\n          },\n          onEditBus: () => {\n            setShowEditBusModal(true);\n          },\n          onEditQR: () => {\n            setShowEditQRModal(true);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: 5,\n        children: /*#__PURE__*/_jsxDEV(ItinerarySection, {\n          groupData: groupData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: 4,\n        children: /*#__PURE__*/_jsxDEV(ContactSection, {\n          groupData: groupData,\n          onEditOperations: () => {\n            setShowEditOperationsAgentModal(true);\n          },\n          onEditAssistant: () => {\n            setShowEditAssistantModal(true);\n          },\n          onEditResponsible: () => {\n            setShowEditResponsibleHotelsModal(true);\n          },\n          onOpenMap: () => {/* Lógica para abrir modal de mapa */}\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 414,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      className: \"mt-3\",\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex justify-content-between align-items-center\",\n          children: [/*#__PURE__*/_jsxDEV(Tab.Container, {\n            activeKey: activeTab,\n            onSelect: k => setActiveTab(k),\n            children: /*#__PURE__*/_jsxDEV(Nav, {\n              variant: \"tabs\",\n              children: [/*#__PURE__*/_jsxDEV(Nav.Item, {\n                children: /*#__PURE__*/_jsxDEV(Nav.Link, {\n                  eventKey: \"clientes\",\n                  as: Link,\n                  to: `/grupo/${id}?table=clientes`,\n                  children: \"Clientes\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 433,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 432,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Nav.Item, {\n                children: /*#__PURE__*/_jsxDEV(Nav.Link, {\n                  eventKey: \"hoteles\",\n                  as: Link,\n                  to: `/grupo/${id}?table=hoteles`,\n                  children: \"Hoteles\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 438,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 437,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Nav.Item, {\n                children: /*#__PURE__*/_jsxDEV(Nav.Link, {\n                  eventKey: \"cuartos\",\n                  as: Link,\n                  to: `/grupo/${id}?table=cuartos`,\n                  children: \"Cuartos\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 443,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 442,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Nav.Item, {\n                children: /*#__PURE__*/_jsxDEV(Nav.Link, {\n                  eventKey: \"opcionales\",\n                  as: Link,\n                  to: `/grupo/${id}?table=opcionales`,\n                  children: \"Opcionales\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 448,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 447,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Nav.Item, {\n                children: /*#__PURE__*/_jsxDEV(Nav.Link, {\n                  eventKey: \"liquidacion\",\n                  as: Link,\n                  to: `/grupo/${id}?table=liquidacion`,\n                  children: \"Liquidaci\\xF3n\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 453,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 452,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 431,\n              columnNumber: 15\n            }, this)\n          }, id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 430,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex justify-content-end\",\n            style: {\n              marginLeft: 'auto'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn-custom me-2\",\n              onClick: () => setShowFilterModal(true),\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-filter\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 462,\n                columnNumber: 17\n              }, this), \" Filtro\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 461,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn-custom\",\n              id: \"exportButton\",\n              onClick: () => {/* Lógica para exportar datos */},\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-file-export\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 465,\n                columnNumber: 17\n              }, this), \" Exportar Datos\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 464,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Tab.Container, {\n          activeKey: activeTab,\n          onSelect: k => setActiveTab(k),\n          children: /*#__PURE__*/_jsxDEV(Tab.Content, {\n            className: \"mt-3\",\n            children: [/*#__PURE__*/_jsxDEV(Tab.Pane, {\n              eventKey: \"clientes\",\n              children: /*#__PURE__*/_jsxDEV(ClientsTable, {\n                data: tableData\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 472,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 471,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Tab.Pane, {\n              eventKey: \"hoteles\",\n              children: /*#__PURE__*/_jsxDEV(HotelAssignmentsTable, {\n                data: tableData,\n                groupPax: groupData.PAX,\n                onEditAssignment: assignment => {\n                  setShowHotelModal(true);\n                  setHotelInitialData(assignment);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 475,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Tab.Pane, {\n              eventKey: \"cuartos\",\n              children: [/*#__PURE__*/_jsxDEV(Row, {\n                className: \"mb-3\",\n                children: /*#__PURE__*/_jsxDEV(Col, {\n                  children: /*#__PURE__*/_jsxDEV(CitySubMenu, {\n                    cities: Object.keys(dayOptions),\n                    selectedCity: selectedCity,\n                    onSelectCity: setSelectedCity\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 487,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 486,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 485,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Row, {\n                children: /*#__PURE__*/_jsxDEV(Col, {\n                  children: /*#__PURE__*/_jsxDEV(RoomsTable, {\n                    roomAssignments: roomAssignments,\n                    onEditAssignment: handleEditRoom\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 497,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 496,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 495,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 484,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Tab.Pane, {\n              eventKey: \"opcionales\",\n              children: /*#__PURE__*/_jsxDEV(OptionalsSection, {\n                data: tableData,\n                itinerary: itinerary,\n                idGroup: id,\n                currentDate: Date.now(),\n                onAddOptional: handleAddOptional,\n                onEditOptional: handleEditOptional,\n                onOptionModal: handleOptionModal\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 505,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 504,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Tab.Pane, {\n              eventKey: \"liquidacion\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Contenido de liquidaci\\xF3n no implementado a\\xFAn.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 516,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 515,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 470,\n            columnNumber: 13\n          }, this)\n        }, id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 469,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(EditGuideModal, {\n      show: showEditGuideModal,\n      onHide: () => setShowEditGuideModal(false),\n      groupData: groupData,\n      onGuideUpdated: newGuide => {\n        setGroupData({\n          ...groupData,\n          guide_name: newGuide.name\n        });\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 524,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(EditBusModal, {\n      show: showEditBusModal,\n      onHide: () => setShowEditBusModal(false),\n      groupData: groupData,\n      onBusUpdated: updatedBus => {\n        setGroupData({\n          ...groupData,\n          bus_company: updatedBus.company_name,\n          bus_code: updatedBus.bus_code\n        });\n        fetchGroupData();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 532,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(EditQRModal, {\n      show: showEditQRModal,\n      onHide: () => setShowEditQRModal(false),\n      groupData: groupData,\n      onQRUpdated: newQR => {\n        setGroupData({\n          ...groupData,\n          QR: newQR\n        });\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 545,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(EditOperationsAgentModal, {\n      show: showEditOperationsAgentModal,\n      onHide: () => setShowEditOperationsAgentModal(false),\n      groupData: groupData,\n      onOperationsUpdated: updatedOperations => {\n        setGroupData({\n          ...groupData,\n          id_operations: updatedOperations.id,\n          operaciones_name: updatedOperations.name\n        });\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 553,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(EditAssistantModal, {\n      show: showEditAssistantModal,\n      onHide: () => setShowEditAssistantModal(false),\n      groupData: groupData,\n      onAssistantUpdated: updatedAssistant => {\n        setGroupData({\n          ...groupData,\n          id_assistant: updatedAssistant.id,\n          nombre_asistente: updatedAssistant.name\n        });\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 565,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(EditResponsibleHotelsModal, {\n      show: showEditResponsibleHotelsModal,\n      onHide: () => setShowEditResponsibleHotelsModal(false),\n      groupData: groupData,\n      onResponsibleUpdated: updatedResponsible => {\n        setGroupData({\n          ...groupData,\n          id_responsible_hotels: updatedResponsible.name\n        });\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 577,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AddOptionalModal, {\n      show: showAddOptionalModal,\n      onHide: () => setShowAddOptionalModal(false),\n      clientId: optionalClientData.clientId,\n      groupId: groupData.id_group,\n      city: optionalClientData.city,\n      cityDays: optionalClientData.cityDays,\n      clientName: optionalClientData.clientName,\n      onOptionalAdded: data => {\n        fetchGroupData();\n      },\n      clientAge: clientAges[optionalClientData.clientId]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 586,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(EditOptionalModal, {\n      show: showEditOptionalModal,\n      onHide: () => setShowEditOptionalModal(false),\n      clientId: (_currentOptionParams$ = currentOptionParams.client) === null || _currentOptionParams$ === void 0 ? void 0 : _currentOptionParams$.id_clients,\n      groupId: groupData.id_group,\n      currentOptionalData: currentOptionalData,\n      optionalClientData: currentOptionParams,\n      onOptionalUpdated: data => {\n        fetchGroupData();\n      },\n      clientAge: clientAges[optionalClientData.clientId]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 599,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DeleteOptionalModal, {\n      show: showDeleteOptionalModal,\n      onHide: () => setShowDeleteOptionalModal(false),\n      clientId: (_currentOptionParams$2 = currentOptionParams.client) === null || _currentOptionParams$2 === void 0 ? void 0 : _currentOptionParams$2.id_clients,\n      groupId: groupData.id_group,\n      dayId: optionalClientData.dayId,\n      optionalData: currentOptionalData,\n      onOptionalDeleted: data => {\n        fetchGroupData();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 611,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(OptionModal, {\n      show: showOptionModal,\n      onHide: () => setShowOptionModal(false),\n      client: (_currentOptionParams$3 = currentOptionParams.client) === null || _currentOptionParams$3 === void 0 ? void 0 : _currentOptionParams$3.id_clients,\n      dayId: currentOptionParams.dayId,\n      city: currentOptionParams.city,\n      groupId: groupData.id_group,\n      cityDays: currentOptionParams.cityDays,\n      onAdd: handleOptionModalAdd,\n      onEdit: handleOptionModalEdit,\n      onDelete: handleOptionModalDelete\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 622,\n      columnNumber: 7\n    }, this), activeTab === 'opcionales' && /*#__PURE__*/_jsxDEV(OptionalsFilterModal, {\n      show: showFilterModal,\n      onHide: () => setShowFilterModal(false),\n      idGroup: groupData.id_group,\n      current_table: activeTab,\n      onFiltersApplied: filters => {\n        const filtersParam = encodeURIComponent(JSON.stringify(filters));\n        navigate(`/grupo/${groupData.id_group}?table=${activeTab}&filters=${filtersParam}`);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 635,\n      columnNumber: 9\n    }, this), activeTab === 'hoteles' && /*#__PURE__*/_jsxDEV(HotelFilterModal, {\n      show: showFilterModal,\n      idGroup: groupData.id_group,\n      onHide: () => setShowFilterModal(false),\n      onApplyFilters: filters => {\n        const filtersParam = encodeURIComponent(JSON.stringify(filters));\n        navigate(`/grupo/${groupData.id_group}?table=${activeTab}&filters=${filtersParam}`);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 648,\n      columnNumber: 9\n    }, this), activeTab === 'cuartos' && /*#__PURE__*/_jsxDEV(RoomFilterModal, {\n      show: showFilterModal,\n      onHide: () => setShowFilterModal(false),\n      onApplyFilters: filters => {\n        const filtersParam = encodeURIComponent(JSON.stringify(filters));\n        navigate(`/grupo/${groupData.id_group}?table=cuartos&filters=${filtersParam}`);\n      },\n      availableHotels: availableHotels,\n      availableCities: availableCity,\n      availableRoomTypes: availableRooms\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 659,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(HotelModal, {\n      show: showHotelModal,\n      onHide: () => setShowHotelModal(false),\n      initialData: hotelInitialData || {},\n      groupPax: groupData.PAX,\n      onSave: payload => {\n        return fetch(`${process.env.REACT_APP_API_URL}/hotels_reservation/update_hotel_reservation`, {\n          method: hotelInitialData !== null && hotelInitialData !== void 0 && hotelInitialData.assignment_id ? 'PUT' : 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(payload)\n        }).then(async response => {\n          if (!response.ok) {\n            const errorData = await response.json();\n            // Lanza el error para que el modal lo capture y lo muestre\n            throw errorData;\n          }\n          return response.json();\n        }).then(data => {\n          if (data.status === 'success') {\n            fetchGroupData(); // Actualiza los datos del grupo\n          }\n          return data;\n        });\n      },\n      onAddAnother: handleOpenHotelAddAnother\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 672,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(HotelAddAnotherModal, {\n      show: showHotelAddAnotherModal,\n      onHide: () => {\n        setShowHotelAddAnotherModal(false);\n        setHotelAddAnotherInitialData({}); // Reiniciamos si es necesario\n      },\n      initialData: hotelAddAnotherInitialData,\n      groupPax: groupData.PAX,\n      assignedPaxTotal: hotelAddAnotherInitialData.new_pax || 0,\n      onSave: payload => {\n        // Llamar al endpoint para agregar otra asignación para el mismo día.\n        fetch(`${process.env.REACT_APP_API_URL}/hotels_reservation/asign_hotel_same_day`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(payload)\n        }).then(r => r.json()).then(data => {\n          if (data.status === 'success') {\n            fetchGroupData();\n          } else {\n            alert('Error al agregar asignación: ' + data.message);\n          }\n          return data;\n        }).catch(error => {\n          console.error('Error:', error);\n          alert('Error al agregar la asignación.');\n        });\n      },\n      onAddAnother: handleOpenHotelAddAnother\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 701,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(RoomAssignmentModal, {\n      show: showRoomModal,\n      onHide: () => setShowRoomModal(false),\n      initialData: roomModalData || {},\n      onSave: payload => {\n        // Aquí realizas la llamada al endpoint para guardar la modificación del cuarto.\n        return fetch(`${process.env.REACT_APP_API_URL}/hotels_room/update_client_room`, {\n          method: roomModalData !== null && roomModalData !== void 0 && roomModalData.id ? 'PUT' : 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(payload)\n        }).then(res => res.json()).then(data => {\n          if (data.status === 'success') {\n            fetchRoomAssignments(); // Actualiza la tabla de cuartos\n            return data;\n          } else if (data.status_code === 400) {\n            throw new Error(data.detail || 'Error al guardar la asignación');\n          } else {\n            throw new Error(data.message || 'Error al guardar la asignación');\n          }\n        });\n      },\n      availableHotels: availableHotels\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 734,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 391,\n    columnNumber: 5\n  }, this);\n};\n_s(GroupDetail, \"CPBhjU9j8hBIf635Uh3HjzUXC6c=\", false, function () {\n  return [useParams, useLocation, useNavigate];\n});\n_c = GroupDetail;\nexport default GroupDetail;\nvar _c;\n$RefreshReg$(_c, \"GroupDetail\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","Button","Container","Row","Col","Tab","Nav","Spinner","useParams","useLocation","Link","useNavigate","InfoGeneral","ItinerarySection","ContactSection","ClientsTable","OptionalsSection","OptionalsFilterModal","HotelAssignmentsTable","HotelModal","HotelAddAnotherModal","HotelFilterModal","RoomsTable","CitySubMenu","RoomAssignmentModal","RoomFilterModal","EditGuideModal","EditBusModal","EditQRModal","EditOperationsAgentModal","EditAssistantModal","EditResponsibleHotelsModal","AddOptionalModal","EditOptionalModal","DeleteOptionalModal","OptionModal","jsxDEV","_jsxDEV","GroupDetail","_s","_currentOptionParams$","_currentOptionParams$2","_currentOptionParams$3","id","location","navigate","queryParams","URLSearchParams","search","initialTable","get","filters","activeTab","setActiveTab","showFilterModal","setShowFilterModal","groupData","setGroupData","tableData","setTableData","itinerary","setItinerary","clientAges","setClientAges","loading","setLoading","showEditGuideModal","setShowEditGuideModal","showEditBusModal","setShowEditBusModal","showEditQRModal","setShowEditQRModal","showEditOperationsAgentModal","setShowEditOperationsAgentModal","showEditAssistantModal","setShowEditAssistantModal","showEditResponsibleHotelsModal","setShowEditResponsibleHotelsModal","showAddOptionalModal","setShowAddOptionalModal","showEditOptionalModal","setShowEditOptionalModal","showDeleteOptionalModal","setShowDeleteOptionalModal","currentOptionalData","setCurrentOptionalData","optionalClientData","setOptionalClientData","clientId","city","cityDays","clientName","dayId","showOptionModal","setShowOptionModal","currentOptionParams","setCurrentOptionParams","client","showHotelModal","setShowHotelModal","hotelInitialData","setHotelInitialData","showHotelAddAnotherModal","setShowHotelAddAnotherModal","hotelAddAnotherInitialData","setHotelAddAnotherInitialData","showHotelFilterModal","setShowHotelFilterModal","dayOptions","setDayOptions","selectedCity","setSelectedCity","roomAssignments","setRoomAssignments","showRoomModal","setShowRoomModal","roomModalData","setRoomModalData","availableHotels","setAvailableHotels","availableCity","setAvailableCity","availableRooms","setAvailableRooms","fetchGroupData","apiUrl","process","env","REACT_APP_API_URL","params","id_group","table","append","fetch","toString","then","response","ok","Error","json","data","group_data","table_data","client_ages","catch","error","console","finally","fetchDayOptions","res","cities","Object","keys","length","err","fetchRoomAssignments","id_days","method","headers","body","JSON","stringify","Array","isArray","handleEditRoom","assignment","formatDateToISO","dateStr","year","day","month","split","Date","getFullYear","formattedDate","date","log","handleOptionModal","cityInfo","optional","day_optionals","handleOptionModalAdd","id_clients","first_name","paternal_surname","handleOptionModalEdit","alert","handleOptionModalDelete","handleAddOptional","handleEditOptional","cityFound","find","ci","days","some","d","newOptionalClientData","handleApplyFilter","filtersObj","filtersParam","encodeURIComponent","handleApplyHotelFilters","handleOpenHotelAddAnother","assignmentData","prev","new_pax","Number","id_day","paxAssigned","handleCloseHotelAddAnother","className","children","animation","role","fileName","_jsxFileName","lineNumber","columnNumber","fluid","nombre_circuito","md","onEditGuide","onEditBus","onEditQR","onEditOperations","onEditAssistant","onEditResponsible","onOpenMap","activeKey","onSelect","k","variant","Item","eventKey","as","to","style","marginLeft","onClick","Content","Pane","groupPax","PAX","onEditAssignment","onSelectCity","idGroup","currentDate","now","onAddOptional","onEditOptional","onOptionModal","show","onHide","onGuideUpdated","newGuide","guide_name","name","onBusUpdated","updatedBus","bus_company","company_name","bus_code","onQRUpdated","newQR","QR","onOperationsUpdated","updatedOperations","id_operations","operaciones_name","onAssistantUpdated","updatedAssistant","id_assistant","nombre_asistente","onResponsibleUpdated","updatedResponsible","id_responsible_hotels","groupId","onOptionalAdded","clientAge","onOptionalUpdated","optionalData","onOptionalDeleted","onAdd","onEdit","onDelete","current_table","onFiltersApplied","onApplyFilters","availableCities","availableRoomTypes","initialData","onSave","payload","assignment_id","errorData","status","onAddAnother","assignedPaxTotal","r","message","status_code","detail","_c","$RefreshReg$"],"sources":["C:/Users/Bautista/Documents/Proyectos/bayTours/bayTours/frontend_2.0/baytours-react/src/pages/GroupDetail.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { Button, Container, Row, Col, Tab, Nav, Spinner } from 'react-bootstrap';\r\nimport { useParams, useLocation, Link, useNavigate    } from 'react-router-dom';\r\n\r\n// Importamos nuestros nuevos componentes refactorizados\r\nimport InfoGeneral from '../components/GroupDetail/InfoGeneral';\r\nimport ItinerarySection from '../components/GroupDetail/ItinerarySection';\r\nimport ContactSection from '../components/GroupDetail/ContactSection';\r\n\r\n// Componentes principales para mostrar datos\r\nimport ClientsTable from '../components/ClientsTable';\r\nimport OptionalsSection from '../components/OptionalsSection';\r\nimport OptionalsFilterModal from '../components/OptionalsFilterModal';\r\n\r\nimport HotelAssignmentsTable from '../components/HotelAssignmentsTable'; // Placeholder para asignaciones de hoteles\r\nimport HotelModal from '../components/GroupDetail/modals/HotelModal';\r\n// Importamos el modal para agregar otro hotel (HotelAddAnotherModal.jsx)\r\nimport HotelAddAnotherModal from '../components/GroupDetail/modals/HotelAddAnotherModal';\r\nimport HotelFilterModal from '../components/GroupDetail/modals/HotelFilterModal';\r\n\r\n\r\n// Importar los modales para los cuartos \r\nimport RoomsTable from '../components/GroupDetail/RoomsTable';\r\nimport CitySubMenu from '../components/GroupDetail/CitySubmenu';\r\nimport RoomAssignmentModal from '../components/GroupDetail/modals/RoomAssignmentModal';\r\nimport RoomFilterModal from '../components/GroupDetail/modals/RoomFilterModal';\r\n\r\n// Modales para edición de información general\r\nimport EditGuideModal from '../components/GroupDetail/modals/EditGuideModal';\r\nimport EditBusModal from '../components/GroupDetail/modals/EditBusModal';\r\nimport EditQRModal from '../components/GroupDetail/modals/EditQRModal';\r\n\r\n// Importar los nuevos modales\r\nimport EditOperationsAgentModal from '../components/GroupDetail/modals/EditOperationsAgentModal';\r\nimport EditAssistantModal from '../components/GroupDetail/modals/EditAssistantModal';\r\nimport EditResponsibleHotelsModal from '../components/GroupDetail/modals/EditResponsibleHotelsModal';\r\n\r\n// Importar modales para opcionales (Add, Edit y Delete)\r\nimport AddOptionalModal from '../components/GroupDetail/modals/AddOptionalModal';\r\nimport EditOptionalModal from '../components/GroupDetail/modals/EditOptionalModal';\r\nimport DeleteOptionalModal from '../components/GroupDetail/modals/DeleteOptionalModal';\r\n\r\nimport OptionModal from '../components/GroupDetail/modals/OptionModal';\r\n// ... otros modales que necesites\r\n\r\n\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\n\r\nconst GroupDetail = () => {\r\n  const { id } = useParams();\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n\r\n  // Extraer parámetros de la query string: tabla activa y filtros\r\n  const queryParams = new URLSearchParams(location.search);\r\n  const initialTable = queryParams.get('table') || 'clientes';\r\n  const filters = queryParams.get('filters') || null;\r\n\r\n  // --- Estados locales ---\r\n\r\n  // Estado de la pestaña activa (por defecto, la que viene en la URL)\r\n  const [activeTab, setActiveTab] = useState(initialTable);\r\n\r\n  // Estado para mostrar el modal de filtro (aplica a la tabla activa)\r\n  const [showFilterModal, setShowFilterModal] = useState(false);\r\n\r\n  // Estados para almacenar los datos del grupo\r\n  const [groupData, setGroupData] = useState(null);\r\n  const [tableData, setTableData] = useState([]);\r\n  const [itinerary, setItinerary] = useState([]);\r\n  const [clientAges, setClientAges] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Estados para modales de información general\r\n  const [showEditGuideModal, setShowEditGuideModal] = useState(false);\r\n  const [showEditBusModal, setShowEditBusModal] = useState(false);\r\n  const [showEditQRModal, setShowEditQRModal] = useState(false);\r\n\r\n  // Estados para modales de contacto\r\n  const [showEditOperationsAgentModal, setShowEditOperationsAgentModal] = useState(false);\r\n  const [showEditAssistantModal, setShowEditAssistantModal] = useState(false);\r\n  const [showEditResponsibleHotelsModal, setShowEditResponsibleHotelsModal] = useState(false);\r\n  // Estados para modales de opcionales\r\n  const [showAddOptionalModal, setShowAddOptionalModal] = useState(false);\r\n  const [showEditOptionalModal, setShowEditOptionalModal] = useState(false);\r\n  const [showDeleteOptionalModal, setShowDeleteOptionalModal] = useState(false);\r\n  const [currentOptionalData, setCurrentOptionalData] = useState(null);\r\n\r\n  // Datos para el modal de opcionales (cliente y día seleccionados)\r\n  const [optionalClientData, setOptionalClientData] = useState({\r\n    clientId: '',\r\n    city: '',\r\n    cityDays: [],\r\n    clientName: '',\r\n    dayId: ''\r\n  });\r\n  const [showOptionModal, setShowOptionModal] = useState(false);\r\n  const [currentOptionParams, setCurrentOptionParams] = useState({\r\n    client: null,\r\n    dayId: '',\r\n    city: '',\r\n    cityDays: [],\r\n  });\r\n\r\n  // Estado para el modal de hoteles\r\n  const [showHotelModal, setShowHotelModal] = useState(false);\r\n  const [hotelInitialData, setHotelInitialData] = useState(null);\r\n\r\n  // Estado para el modal de agregar otro hotel para el mismo día (nuevo)\r\n  const [showHotelAddAnotherModal, setShowHotelAddAnotherModal] = useState(false);\r\n  const [hotelAddAnotherInitialData, setHotelAddAnotherInitialData] = useState({});\r\n  const [showHotelFilterModal, setShowHotelFilterModal] = useState(false);\r\n\r\n  // Estados para la sección de cuartos\r\n  const [dayOptions, setDayOptions] = useState({}); \r\n  const [selectedCity, setSelectedCity] = useState('');\r\n  const [roomAssignments, setRoomAssignments] = useState([]);\r\n  const [showRoomModal, setShowRoomModal] = useState(false);\r\n  const [roomModalData, setRoomModalData] = useState(null);\r\n  const [availableHotels, setAvailableHotels] = useState([]);\r\n  const [availableCity, setAvailableCity] = useState([]);\r\n  const [availableRooms, setAvailableRooms] = useState([]);\r\n  \r\n  // --- Función para obtener datos del grupo ---\r\n  const fetchGroupData = useCallback(() => {\r\n    const apiUrl = `${process.env.REACT_APP_API_URL}/groups/group_data`;\r\n    // Se envía la pestaña activa (clientes, hoteles, etc.) en la variable \"table\"\r\n    const params = new URLSearchParams({ id_group: id, table: activeTab });\r\n    if (filters) {\r\n      params.append('filters', filters);\r\n    }\r\n    fetch(`${apiUrl}?${params.toString()}`)\r\n      .then(response => {\r\n        if (!response.ok)\r\n          throw new Error('Error al obtener los datos del grupo');\r\n        return response.json();\r\n      })\r\n      .then(data => {\r\n        setGroupData(data.group_data);\r\n        setTableData(data.table_data);\r\n        setItinerary(data.itinerary || []);\r\n        setClientAges(data.client_ages || {});\r\n      })\r\n      .catch(error => console.error('Error al obtener el detalle del grupo:', error))\r\n      .finally(() => setLoading(false));\r\n  }, [id , activeTab, filters]);\r\n\r\n  // Actualizar datos cada vez que cambie el id, la pestaña activa o los filtros\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    fetchGroupData();\r\n  }, [fetchGroupData]);\r\n\r\n  // --- Callbacks para manejar modales de opcionales ---\r\n  // Función para obtener las opciones de días (submenú de ciudades)\r\nconst fetchDayOptions = () => {\r\n  fetch(`${process.env.REACT_APP_API_URL}/days/get_day_id?id_group=${groupData.id_group}`)\r\n    .then(res => res.json())\r\n    .then(data => {\r\n      setDayOptions(data);\r\n      // Si no hay ciudad seleccionada, elegir la primera clave\r\n      const cities = Object.keys(data);\r\n      if (cities.length > 0 && !selectedCity) {\r\n        setSelectedCity(cities[0]);\r\n      }\r\n    })\r\n    .catch(err => console.error('Error al obtener opciones de días:', err));\r\n};\r\n\r\n// Función para obtener asignaciones de cuartos según id_days\r\nconst fetchRoomAssignments = () => {\r\n  if (selectedCity && dayOptions[selectedCity]) {\r\n    const id_days = dayOptions[selectedCity]; // Esto es un array de strings\r\n    fetch(`${process.env.REACT_APP_API_URL}/rooms/`, {\r\n      method: 'PUT',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(id_days),\r\n    })\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if (Array.isArray(data)) {\r\n          setRoomAssignments(data);\r\n        }\r\n      })\r\n      .catch(err => console.error('Error al obtener asignaciones de cuartos:', err));\r\n  }\r\n};\r\n\r\n  useEffect(() => {\r\n    if (groupData) {\r\n      fetchDayOptions();\r\n    }\r\n  }, [groupData]);\r\n\r\n  useEffect(() => {\r\n    // Cada vez que cambia la ciudad seleccionada, actualizamos la tabla de cuartos\r\n    if (selectedCity) {\r\n      fetchRoomAssignments();\r\n    }\r\n  }, [selectedCity, dayOptions]);\r\n\r\n  \r\n  const handleEditRoom = (assignment) => {\r\n    // Función para convertir la fecha de \"DD/MM\" a \"YYYY-MM-DD\"\r\n    const formatDateToISO = (dateStr, year) => {\r\n      const [day, month] = dateStr.split('/');\r\n      return `${year}-${month}-${day}`;\r\n    };\r\n\r\n    // Supongamos que assignment.date tiene el formato \"DD/MM\" y necesitas agregar el año\r\n    const year = new Date().getFullYear(); // Puedes ajustar esto según sea necesario\r\n    const formattedDate = formatDateToISO(assignment.date, year);\r\n    \r\n    // Asumiendo que assignment tiene, entre otros, \"city\" y \"date\"\r\n    // Llama al endpoint para obtener los hoteles disponibles para esa ciudad y fecha\r\n    fetch(`${process.env.REACT_APP_API_URL}/hotels_reservation/get_by_group_and_date?id_group=${groupData.id_group}&date_day=${formattedDate}`)\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if (Array.isArray(data)) {\r\n          setAvailableHotels(data); \r\n        } else {\r\n          setAvailableHotels([]);\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.error('Error al obtener hoteles disponibles:', err);\r\n        setAvailableHotels([]);\r\n      });\r\n    \r\n    setRoomModalData(assignment);\r\n    setShowRoomModal(true);\r\n\r\n    fetch(`${process.env.REACT_APP_API_URL}/rooms/city?id_days=${roomModalData.id_days}`)\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        console.log('Ciudades disponibles:', data);\r\n        setAvailableCity(data);\r\n      })\r\n      .catch(err => console.error('Error al obtener Ciudades disponibles:', err));\r\n\r\n    fetch(`${process.env.REACT_APP_API_URL}/rooms/room?id_days=${roomModalData.id_days}`)\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        console.log('Habitaciones disponibles:', data);\r\n        setAvailableRooms(data);\r\n      })\r\n      .catch(err => console.error('Error al obtener Hbitaciones disponibles:', err));\r\n  };\r\n\r\n  // Abre el modal intermedio de opciones (Editar, Agregar, Borrar) para un cliente en un día específico\r\n  const handleOptionModal = (client, dayId, cityInfo, cityDays, optional = null) => {\r\n    setCurrentOptionParams({\r\n      client,\r\n      dayId,\r\n      city: cityInfo.city,\r\n      cityDays,\r\n    });\r\n    // Si el cliente ya tiene opcionales para ese día, preselecciona el primero\r\n    if (optional) {\r\n      setCurrentOptionalData(optional);\r\n    } else if (client.day_optionals && client.day_optionals[dayId] && client.day_optionals[dayId].length > 0) {\r\n      setCurrentOptionalData(client.day_optionals[dayId][0]);\r\n    } else {\r\n      setCurrentOptionalData(null);\r\n    }\r\n    setShowOptionModal(true);\r\n  };\r\n\r\n  // Acción \"Agregar\" desde el modal de opciones\r\n  const handleOptionModalAdd = () => {\r\n    setOptionalClientData({\r\n      clientId: currentOptionParams.client.id_clients,\r\n      city: currentOptionParams.city,\r\n      cityDays: currentOptionParams.cityDays,\r\n      clientName: `${currentOptionParams.client.first_name} ${currentOptionParams.client.paternal_surname}`,\r\n      dayId: currentOptionParams.dayId,\r\n    });\r\n    setShowAddOptionalModal(true);\r\n  };\r\n\r\n  // Acción \"Editar\" desde el modal de opciones\r\n  const handleOptionModalEdit = () => {\r\n    if (currentOptionalData) {\r\n      setShowEditOptionalModal(true);\r\n    } else {\r\n      alert('No hay opcionales para editar en este día.');\r\n    }\r\n  };\r\n\r\n  // Acción \"Borrar\" desde el modal de opciones\r\n  const handleOptionModalDelete = () => {\r\n    setCurrentOptionalData(currentOptionalData);\r\n    setShowDeleteOptionalModal(true);\r\n  };\r\n\r\n  // Función para manejar la acción directa \"Agregar\" (sin pasar por el modal intermedio)\r\n  const handleAddOptional = (client, dayId, city, cityDays) => {\r\n    setOptionalClientData({\r\n      clientId: client.id_clients,\r\n      city,\r\n      cityDays,\r\n      clientName: `${client.first_name} ${client.paternal_surname}`,\r\n      dayId\r\n    });\r\n    setShowAddOptionalModal(true);\r\n  };\r\n\r\n  // Función para manejar la acción directa \"Editar\" de un opcional\r\n  const handleEditOptional = (client, dayId, optional) => {\r\n    const cityFound = itinerary.find(ci => ci.days.some(d => d.id === dayId));\r\n    const newOptionalClientData = {\r\n      clientId: client.id_clients,\r\n      city: cityFound ? cityFound.city : '',\r\n      cityDays: cityFound ? cityFound.days : [],\r\n      clientName: `${client.first_name} ${client.paternal_surname}`,\r\n      dayId\r\n    };\r\n    setOptionalClientData(newOptionalClientData);\r\n    setCurrentOptionParams({\r\n      ...newOptionalClientData,\r\n      client\r\n    });\r\n    setCurrentOptionalData(optional);\r\n    setShowEditOptionalModal(true);\r\n  };\r\n\r\n  // Callback para aplicar filtros desde el modal de filtro\r\n  const handleApplyFilter = (filtersObj) => {\r\n    const filtersParam = encodeURIComponent(JSON.stringify(filtersObj));\r\n    navigate(`/grupo/${groupData.id_group}?table=${activeTab}&filters=${filtersParam}`);\r\n  };\r\n\r\n  const handleApplyHotelFilters = (filters) => {\r\n    const filtersParam = encodeURIComponent(JSON.stringify(filters));\r\n    navigate(`/grupo/${groupData.id_group}?table=hoteles&filters=${filtersParam}`);\r\n  };\r\n\r\n  // Ejemplo de callback para abrir el modal de agregar otro hotel:\r\n  const handleOpenHotelAddAnother = (assignmentData) => {\r\n    console.log('Datos de la asignación actual:', assignmentData);\r\n    // Si el modal no está abierto, reiniciamos; de lo contrario, acumulamos\r\n    setHotelAddAnotherInitialData((prev) => {\r\n      if (!showHotelAddAnotherModal) {\r\n        return {\r\n          city: assignmentData.city,\r\n          date: assignmentData.date,\r\n          id_group: groupData.id_group,\r\n          new_pax: Number(assignmentData.new_pax || 0),\r\n          id_day: assignmentData.id_day,\r\n        };\r\n      } else {\r\n        return {\r\n          city: assignmentData.city,\r\n          date: assignmentData.date,\r\n          id_group: groupData.id_group,\r\n          new_pax: Number(assignmentData.paxAssigned  || 0),\r\n          id_day: assignmentData.id_day,\r\n        };\r\n      }\r\n    });\r\n    // O, alternativamente, forzar el reinicio cuando se cierra el modal\r\n    setShowHotelAddAnotherModal(true);\r\n  };\r\n\r\n  const handleCloseHotelAddAnother = () => {\r\n    setShowHotelAddAnotherModal(false);\r\n    setHotelAddAnotherInitialData({});\r\n  };\r\n\r\n\r\n  // --- Renderizado de la interfaz ---\r\n\r\n  // Mientras se cargan los datos, se muestra un spinner\r\n  if (loading) {\r\n    return (\r\n      <Container className=\"text-center py-5\">\r\n        <Spinner animation=\"border\" role=\"status\">\r\n          <span className=\"visually-hidden\">Cargando...</span>\r\n        </Spinner>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  // Si no se encontró el grupo, se muestra un mensaje de error\r\n  if (!groupData) {\r\n    return <Container><p>Error: Grupo no encontrado.</p></Container>;\r\n  }\r\n\r\n  return (\r\n    <Container fluid>\r\n      {/* Título del Grupo */}\r\n      <Row className=\"mt-1\">\r\n        <Col className=\"text-center\">\r\n          <h3 className=\"mt-1 mb-1\">\r\n            {groupData.id_group}: {groupData.nombre_circuito}\r\n          </h3>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Sección Superior: Información General, Itinerario y Contacto */}\r\n      <Row className=\"mt-3\">\r\n        <Col md={3}>\r\n          <InfoGeneral \r\n            groupData={groupData} \r\n            onEditGuide={() => {setShowEditGuideModal(true)}} \r\n            onEditBus={() => {setShowEditBusModal(true)}} \r\n            onEditQR={() => {setShowEditQRModal(true)}} \r\n          />\r\n        </Col>\r\n        <Col md={5}>\r\n          <ItinerarySection groupData={groupData} />\r\n        </Col>\r\n        <Col md={4}>\r\n          <ContactSection \r\n            groupData={groupData} \r\n            onEditOperations={() => {setShowEditOperationsAgentModal(true)}} \r\n            onEditAssistant={() => {setShowEditAssistantModal(true)}} \r\n            onEditResponsible={() => {setShowEditResponsibleHotelsModal(true)}} \r\n            onOpenMap={() => {/* Lógica para abrir modal de mapa */}} \r\n          />\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Pestañas de tablas y botones de filtro/exportación */}\r\n      <Row className=\"mt-3\">\r\n        <Col>\r\n          <div className=\"d-flex justify-content-between align-items-center\">\r\n            {/* Pestañas */}\r\n            <Tab.Container activeKey={activeTab} onSelect={(k) => setActiveTab(k)} key={id}>\r\n              <Nav variant=\"tabs\">\r\n                <Nav.Item>\r\n                  <Nav.Link eventKey=\"clientes\" as={Link} to={`/grupo/${id}?table=clientes`}>\r\n                    Clientes\r\n                  </Nav.Link>\r\n                </Nav.Item>\r\n                <Nav.Item>\r\n                  <Nav.Link eventKey=\"hoteles\" as={Link} to={`/grupo/${id}?table=hoteles`}>\r\n                    Hoteles\r\n                  </Nav.Link>\r\n                </Nav.Item>\r\n                <Nav.Item>\r\n                  <Nav.Link eventKey=\"cuartos\" as={Link} to={`/grupo/${id}?table=cuartos`}>\r\n                    Cuartos\r\n                  </Nav.Link>\r\n                </Nav.Item>\r\n                <Nav.Item>\r\n                  <Nav.Link eventKey=\"opcionales\" as={Link} to={`/grupo/${id}?table=opcionales`}>\r\n                    Opcionales\r\n                  </Nav.Link>\r\n                </Nav.Item>\r\n                <Nav.Item>\r\n                  <Nav.Link eventKey=\"liquidacion\" as={Link} to={`/grupo/${id}?table=liquidacion`}>\r\n                    Liquidación\r\n                  </Nav.Link>\r\n                </Nav.Item>\r\n              </Nav>\r\n            </Tab.Container>\r\n            {/* Botones a la derecha */}\r\n            <div className=\"d-flex justify-content-end\" style={{ marginLeft: 'auto' }}>\r\n              <Button className=\"btn-custom me-2\" onClick={() => setShowFilterModal(true)}>\r\n                <i className=\"fas fa-filter\"></i> Filtro\r\n              </Button>\r\n              <Button className=\"btn-custom\" id=\"exportButton\" onClick={() => { /* Lógica para exportar datos */ }}>\r\n                <i className=\"fas fa-file-export\"></i> Exportar Datos\r\n              </Button>\r\n            </div>\r\n          </div>\r\n          <Tab.Container activeKey={activeTab} onSelect={(k) => setActiveTab(k)} key={id}>\r\n            <Tab.Content className=\"mt-3\">\r\n              <Tab.Pane eventKey=\"clientes\">\r\n                <ClientsTable data={tableData} />\r\n              </Tab.Pane>\r\n              <Tab.Pane eventKey=\"hoteles\">\r\n                <HotelAssignmentsTable\r\n                  data={tableData}\r\n                  groupPax={groupData.PAX}\r\n                  onEditAssignment={(assignment) => {\r\n                    setShowHotelModal(true);\r\n                    setHotelInitialData(assignment);\r\n                  }}\r\n                />\r\n              </Tab.Pane>\r\n              <Tab.Pane eventKey=\"cuartos\">\r\n                <Row className=\"mb-3\">\r\n                  <Col>\r\n                    <CitySubMenu \r\n                      cities={Object.keys(dayOptions)}\r\n                      selectedCity={selectedCity}\r\n                      onSelectCity={setSelectedCity}\r\n                    />\r\n                  </Col>\r\n                </Row>\r\n                {/* Tabla de cuartos */}\r\n                <Row>\r\n                  <Col>\r\n                    <RoomsTable \r\n                      roomAssignments={roomAssignments} \r\n                      onEditAssignment={handleEditRoom}\r\n                    />\r\n                  </Col>\r\n                </Row>\r\n              </Tab.Pane>\r\n              <Tab.Pane eventKey=\"opcionales\">\r\n                <OptionalsSection\r\n                  data={tableData}\r\n                  itinerary={itinerary}\r\n                  idGroup={id}\r\n                  currentDate={Date.now()}\r\n                  onAddOptional={handleAddOptional}\r\n                  onEditOptional={handleEditOptional}\r\n                  onOptionModal={handleOptionModal}\r\n                />\r\n              </Tab.Pane>\r\n              <Tab.Pane eventKey=\"liquidacion\">\r\n                <p>Contenido de liquidación no implementado aún.</p>\r\n              </Tab.Pane>\r\n            </Tab.Content>\r\n          </Tab.Container>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Modales */}\r\n      <EditGuideModal\r\n        show={showEditGuideModal}\r\n        onHide={() => setShowEditGuideModal(false)}\r\n        groupData={groupData}\r\n        onGuideUpdated={(newGuide) => {\r\n          setGroupData({ ...groupData, guide_name: newGuide.name });\r\n        }}\r\n      />\r\n      <EditBusModal\r\n        show={showEditBusModal}\r\n        onHide={() => setShowEditBusModal(false)}\r\n        groupData={groupData}\r\n        onBusUpdated={(updatedBus) => {\r\n          setGroupData({\r\n            ...groupData,\r\n            bus_company: updatedBus.company_name,\r\n            bus_code: updatedBus.bus_code\r\n          });\r\n          fetchGroupData();\r\n        }}\r\n      />\r\n      <EditQRModal\r\n        show={showEditQRModal}\r\n        onHide={() => setShowEditQRModal(false)}\r\n        groupData={groupData}\r\n        onQRUpdated={(newQR) => {\r\n          setGroupData({ ...groupData, QR: newQR });\r\n        }}\r\n      />\r\n      <EditOperationsAgentModal\r\n        show={showEditOperationsAgentModal}\r\n        onHide={() => setShowEditOperationsAgentModal(false)}\r\n        groupData={groupData}\r\n        onOperationsUpdated={(updatedOperations) => {\r\n          setGroupData({\r\n            ...groupData,\r\n            id_operations: updatedOperations.id,\r\n            operaciones_name: updatedOperations.name\r\n          });\r\n        }}\r\n      />\r\n      <EditAssistantModal\r\n        show={showEditAssistantModal}\r\n        onHide={() => setShowEditAssistantModal(false)}\r\n        groupData={groupData}\r\n        onAssistantUpdated={(updatedAssistant) => {\r\n          setGroupData({\r\n            ...groupData,\r\n            id_assistant: updatedAssistant.id,\r\n            nombre_asistente: updatedAssistant.name\r\n          });\r\n        }}\r\n      />\r\n      <EditResponsibleHotelsModal\r\n        show={showEditResponsibleHotelsModal}\r\n        onHide={() => setShowEditResponsibleHotelsModal(false)}\r\n        groupData={groupData}\r\n        onResponsibleUpdated={(updatedResponsible) => {\r\n          setGroupData({ ...groupData, id_responsible_hotels: updatedResponsible.name });\r\n        }}\r\n      />\r\n      {/* Modales para opcionales */}\r\n      <AddOptionalModal\r\n        show={showAddOptionalModal}\r\n        onHide={() => setShowAddOptionalModal(false)}\r\n        clientId={optionalClientData.clientId}\r\n        groupId={groupData.id_group}\r\n        city={optionalClientData.city}\r\n        cityDays={optionalClientData.cityDays}\r\n        clientName={optionalClientData.clientName}\r\n        onOptionalAdded={(data) => {\r\n          fetchGroupData();\r\n        }}\r\n        clientAge={clientAges[optionalClientData.clientId]}\r\n      />\r\n      <EditOptionalModal\r\n        show={showEditOptionalModal}\r\n        onHide={() => setShowEditOptionalModal(false)}\r\n        clientId={currentOptionParams.client?.id_clients}\r\n        groupId={groupData.id_group}\r\n        currentOptionalData={currentOptionalData}\r\n        optionalClientData={currentOptionParams}\r\n        onOptionalUpdated={(data) => {\r\n          fetchGroupData();\r\n        }}\r\n        clientAge={clientAges[optionalClientData.clientId]}\r\n      />\r\n      <DeleteOptionalModal\r\n        show={showDeleteOptionalModal}\r\n        onHide={() => setShowDeleteOptionalModal(false)}\r\n        clientId={currentOptionParams.client?.id_clients}\r\n        groupId={groupData.id_group}\r\n        dayId={optionalClientData.dayId}\r\n        optionalData={currentOptionalData}\r\n        onOptionalDeleted={(data) => {\r\n          fetchGroupData();\r\n        }}\r\n      />\r\n      <OptionModal\r\n        show={showOptionModal}\r\n        onHide={() => setShowOptionModal(false)}\r\n        client={currentOptionParams.client?.id_clients}\r\n        dayId={currentOptionParams.dayId}\r\n        city={currentOptionParams.city}\r\n        groupId={groupData.id_group}\r\n        cityDays={currentOptionParams.cityDays}\r\n        onAdd={handleOptionModalAdd}\r\n        onEdit={handleOptionModalEdit}\r\n        onDelete={handleOptionModalDelete}\r\n      />\r\n      {activeTab === 'opcionales' && (\r\n        <OptionalsFilterModal\r\n          show={showFilterModal}\r\n          onHide={() => setShowFilterModal(false)}\r\n          idGroup={groupData.id_group}\r\n          current_table={activeTab}\r\n          onFiltersApplied={(filters) => {\r\n            const filtersParam = encodeURIComponent(JSON.stringify(filters));\r\n            navigate(`/grupo/${groupData.id_group}?table=${activeTab}&filters=${filtersParam}`);\r\n          }}\r\n        />\r\n        \r\n      )}\r\n      {activeTab === 'hoteles' && (\r\n        <HotelFilterModal\r\n          show={showFilterModal}\r\n          idGroup={groupData.id_group}\r\n          onHide={() => setShowFilterModal(false)}\r\n          onApplyFilters={(filters) => {\r\n            const filtersParam = encodeURIComponent(JSON.stringify(filters));\r\n            navigate(`/grupo/${groupData.id_group}?table=${activeTab}&filters=${filtersParam}`);\r\n          }}\r\n        />\r\n      )}\r\n      {activeTab === 'cuartos' && (\r\n        <RoomFilterModal\r\n          show={showFilterModal}\r\n          onHide={() => setShowFilterModal(false)}\r\n          onApplyFilters={(filters) => {\r\n            const filtersParam = encodeURIComponent(JSON.stringify(filters));\r\n            navigate(`/grupo/${groupData.id_group}?table=cuartos&filters=${filtersParam}`);\r\n          }}\r\n          availableHotels={availableHotels}\r\n          availableCities={availableCity}\r\n          availableRoomTypes={availableRooms}\r\n        />\r\n      )\r\n      }\r\n      <HotelModal\r\n        show={showHotelModal}\r\n        onHide={() => setShowHotelModal(false)}\r\n        initialData={hotelInitialData || {}}\r\n        groupPax={groupData.PAX}\r\n        onSave={(payload) => {\r\n          return fetch(`${process.env.REACT_APP_API_URL}/hotels_reservation/update_hotel_reservation`, {\r\n            method: hotelInitialData?.assignment_id ? 'PUT' : 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify(payload),\r\n          })\r\n            .then(async (response) => {\r\n              if (!response.ok) {\r\n                const errorData = await response.json();\r\n                // Lanza el error para que el modal lo capture y lo muestre\r\n                throw errorData;\r\n              }\r\n              return response.json();\r\n            })\r\n            .then((data) => {\r\n              if (data.status === 'success') {\r\n                fetchGroupData(); // Actualiza los datos del grupo\r\n              }\r\n              return data;\r\n            });\r\n        }}\r\n        onAddAnother={handleOpenHotelAddAnother}\r\n      />\r\n      {/* Modal para Agregar Otro Hotel para el Mismo Día */}\r\n      <HotelAddAnotherModal\r\n        show={showHotelAddAnotherModal}\r\n        onHide={() => {\r\n          setShowHotelAddAnotherModal(false);\r\n          setHotelAddAnotherInitialData({}); // Reiniciamos si es necesario\r\n        }}\r\n        initialData={hotelAddAnotherInitialData}\r\n        groupPax={groupData.PAX}\r\n        assignedPaxTotal={hotelAddAnotherInitialData.new_pax || 0}\r\n        onSave={(payload) => {\r\n          // Llamar al endpoint para agregar otra asignación para el mismo día.\r\n          fetch(`${process.env.REACT_APP_API_URL}/hotels_reservation/asign_hotel_same_day`, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify(payload),\r\n          })\r\n            .then(r => r.json())\r\n            .then(data => {\r\n              if (data.status === 'success') {\r\n                fetchGroupData();\r\n              } else {\r\n                alert('Error al agregar asignación: ' + data.message);\r\n              }\r\n              return data;\r\n            })\r\n            .catch(error => {\r\n              console.error('Error:', error);\r\n              alert('Error al agregar la asignación.');\r\n            });\r\n        }}\r\n        onAddAnother={handleOpenHotelAddAnother}\r\n        \r\n      />\r\n      <RoomAssignmentModal\r\n        show={showRoomModal}\r\n        onHide={() => setShowRoomModal(false)}\r\n        initialData={roomModalData || {}}\r\n        onSave={(payload) => {\r\n          // Aquí realizas la llamada al endpoint para guardar la modificación del cuarto.\r\n          return fetch(`${process.env.REACT_APP_API_URL}/hotels_room/update_client_room`, {\r\n            method: roomModalData?.id ? 'PUT' : 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify(payload)\r\n          })\r\n            .then(res => res.json())\r\n            .then(data => {\r\n              if (data.status === 'success') {\r\n                fetchRoomAssignments(); // Actualiza la tabla de cuartos\r\n                return data;\r\n              } else if(data.status_code === 400) {\r\n                throw new Error(data.detail || 'Error al guardar la asignación');\r\n              } else {\r\n                throw new Error(data.message || 'Error al guardar la asignación');\r\n              }\r\n            });\r\n        }}\r\n        availableHotels={availableHotels}\r\n      />\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default GroupDetail;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AAC/D,SAASC,MAAM,EAAEC,SAAS,EAAEC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,OAAO,QAAQ,iBAAiB;AAChF,SAASC,SAAS,EAAEC,WAAW,EAAEC,IAAI,EAAEC,WAAW,QAAW,kBAAkB;;AAE/E;AACA,OAAOC,WAAW,MAAM,uCAAuC;AAC/D,OAAOC,gBAAgB,MAAM,4CAA4C;AACzE,OAAOC,cAAc,MAAM,0CAA0C;;AAErE;AACA,OAAOC,YAAY,MAAM,4BAA4B;AACrD,OAAOC,gBAAgB,MAAM,gCAAgC;AAC7D,OAAOC,oBAAoB,MAAM,oCAAoC;AAErE,OAAOC,qBAAqB,MAAM,qCAAqC,CAAC,CAAC;AACzE,OAAOC,UAAU,MAAM,6CAA6C;AACpE;AACA,OAAOC,oBAAoB,MAAM,uDAAuD;AACxF,OAAOC,gBAAgB,MAAM,mDAAmD;;AAGhF;AACA,OAAOC,UAAU,MAAM,sCAAsC;AAC7D,OAAOC,WAAW,MAAM,uCAAuC;AAC/D,OAAOC,mBAAmB,MAAM,sDAAsD;AACtF,OAAOC,eAAe,MAAM,kDAAkD;;AAE9E;AACA,OAAOC,cAAc,MAAM,iDAAiD;AAC5E,OAAOC,YAAY,MAAM,+CAA+C;AACxE,OAAOC,WAAW,MAAM,8CAA8C;;AAEtE;AACA,OAAOC,wBAAwB,MAAM,2DAA2D;AAChG,OAAOC,kBAAkB,MAAM,qDAAqD;AACpF,OAAOC,0BAA0B,MAAM,6DAA6D;;AAEpG;AACA,OAAOC,gBAAgB,MAAM,mDAAmD;AAChF,OAAOC,iBAAiB,MAAM,oDAAoD;AAClF,OAAOC,mBAAmB,MAAM,sDAAsD;AAEtF,OAAOC,WAAW,MAAM,8CAA8C;AACtE;;AAGA,OAAO,0BAA0B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAGlC,MAAMC,WAAW,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAAA,IAAAC,qBAAA,EAAAC,sBAAA,EAAAC,sBAAA;EACxB,MAAM;IAAEC;EAAG,CAAC,GAAGnC,SAAS,CAAC,CAAC;EAC1B,MAAMoC,QAAQ,GAAGnC,WAAW,CAAC,CAAC;EAC9B,MAAMoC,QAAQ,GAAGlC,WAAW,CAAC,CAAC;;EAE9B;EACA,MAAMmC,WAAW,GAAG,IAAIC,eAAe,CAACH,QAAQ,CAACI,MAAM,CAAC;EACxD,MAAMC,YAAY,GAAGH,WAAW,CAACI,GAAG,CAAC,OAAO,CAAC,IAAI,UAAU;EAC3D,MAAMC,OAAO,GAAGL,WAAW,CAACI,GAAG,CAAC,SAAS,CAAC,IAAI,IAAI;;EAElD;;EAEA;EACA,MAAM,CAACE,SAAS,EAAEC,YAAY,CAAC,GAAGvD,QAAQ,CAACmD,YAAY,CAAC;;EAExD;EACA,MAAM,CAACK,eAAe,EAAEC,kBAAkB,CAAC,GAAGzD,QAAQ,CAAC,KAAK,CAAC;;EAE7D;EACA,MAAM,CAAC0D,SAAS,EAAEC,YAAY,CAAC,GAAG3D,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAAC4D,SAAS,EAAEC,YAAY,CAAC,GAAG7D,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAAC8D,SAAS,EAAEC,YAAY,CAAC,GAAG/D,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACgE,UAAU,EAAEC,aAAa,CAAC,GAAGjE,QAAQ,CAAC,CAAC,CAAC,CAAC;EAChD,MAAM,CAACkE,OAAO,EAAEC,UAAU,CAAC,GAAGnE,QAAQ,CAAC,IAAI,CAAC;;EAE5C;EACA,MAAM,CAACoE,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGrE,QAAQ,CAAC,KAAK,CAAC;EACnE,MAAM,CAACsE,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGvE,QAAQ,CAAC,KAAK,CAAC;EAC/D,MAAM,CAACwE,eAAe,EAAEC,kBAAkB,CAAC,GAAGzE,QAAQ,CAAC,KAAK,CAAC;;EAE7D;EACA,MAAM,CAAC0E,4BAA4B,EAAEC,+BAA+B,CAAC,GAAG3E,QAAQ,CAAC,KAAK,CAAC;EACvF,MAAM,CAAC4E,sBAAsB,EAAEC,yBAAyB,CAAC,GAAG7E,QAAQ,CAAC,KAAK,CAAC;EAC3E,MAAM,CAAC8E,8BAA8B,EAAEC,iCAAiC,CAAC,GAAG/E,QAAQ,CAAC,KAAK,CAAC;EAC3F;EACA,MAAM,CAACgF,oBAAoB,EAAEC,uBAAuB,CAAC,GAAGjF,QAAQ,CAAC,KAAK,CAAC;EACvE,MAAM,CAACkF,qBAAqB,EAAEC,wBAAwB,CAAC,GAAGnF,QAAQ,CAAC,KAAK,CAAC;EACzE,MAAM,CAACoF,uBAAuB,EAAEC,0BAA0B,CAAC,GAAGrF,QAAQ,CAAC,KAAK,CAAC;EAC7E,MAAM,CAACsF,mBAAmB,EAAEC,sBAAsB,CAAC,GAAGvF,QAAQ,CAAC,IAAI,CAAC;;EAEpE;EACA,MAAM,CAACwF,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGzF,QAAQ,CAAC;IAC3D0F,QAAQ,EAAE,EAAE;IACZC,IAAI,EAAE,EAAE;IACRC,QAAQ,EAAE,EAAE;IACZC,UAAU,EAAE,EAAE;IACdC,KAAK,EAAE;EACT,CAAC,CAAC;EACF,MAAM,CAACC,eAAe,EAAEC,kBAAkB,CAAC,GAAGhG,QAAQ,CAAC,KAAK,CAAC;EAC7D,MAAM,CAACiG,mBAAmB,EAAEC,sBAAsB,CAAC,GAAGlG,QAAQ,CAAC;IAC7DmG,MAAM,EAAE,IAAI;IACZL,KAAK,EAAE,EAAE;IACTH,IAAI,EAAE,EAAE;IACRC,QAAQ,EAAE;EACZ,CAAC,CAAC;;EAEF;EACA,MAAM,CAACQ,cAAc,EAAEC,iBAAiB,CAAC,GAAGrG,QAAQ,CAAC,KAAK,CAAC;EAC3D,MAAM,CAACsG,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGvG,QAAQ,CAAC,IAAI,CAAC;;EAE9D;EACA,MAAM,CAACwG,wBAAwB,EAAEC,2BAA2B,CAAC,GAAGzG,QAAQ,CAAC,KAAK,CAAC;EAC/E,MAAM,CAAC0G,0BAA0B,EAAEC,6BAA6B,CAAC,GAAG3G,QAAQ,CAAC,CAAC,CAAC,CAAC;EAChF,MAAM,CAAC4G,oBAAoB,EAAEC,uBAAuB,CAAC,GAAG7G,QAAQ,CAAC,KAAK,CAAC;;EAEvE;EACA,MAAM,CAAC8G,UAAU,EAAEC,aAAa,CAAC,GAAG/G,QAAQ,CAAC,CAAC,CAAC,CAAC;EAChD,MAAM,CAACgH,YAAY,EAAEC,eAAe,CAAC,GAAGjH,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAACkH,eAAe,EAAEC,kBAAkB,CAAC,GAAGnH,QAAQ,CAAC,EAAE,CAAC;EAC1D,MAAM,CAACoH,aAAa,EAAEC,gBAAgB,CAAC,GAAGrH,QAAQ,CAAC,KAAK,CAAC;EACzD,MAAM,CAACsH,aAAa,EAAEC,gBAAgB,CAAC,GAAGvH,QAAQ,CAAC,IAAI,CAAC;EACxD,MAAM,CAACwH,eAAe,EAAEC,kBAAkB,CAAC,GAAGzH,QAAQ,CAAC,EAAE,CAAC;EAC1D,MAAM,CAAC0H,aAAa,EAAEC,gBAAgB,CAAC,GAAG3H,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAAC4H,cAAc,EAAEC,iBAAiB,CAAC,GAAG7H,QAAQ,CAAC,EAAE,CAAC;;EAExD;EACA,MAAM8H,cAAc,GAAG5H,WAAW,CAAC,MAAM;IACvC,MAAM6H,MAAM,GAAG,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,oBAAoB;IACnE;IACA,MAAMC,MAAM,GAAG,IAAIlF,eAAe,CAAC;MAAEmF,QAAQ,EAAEvF,EAAE;MAAEwF,KAAK,EAAE/E;IAAU,CAAC,CAAC;IACtE,IAAID,OAAO,EAAE;MACX8E,MAAM,CAACG,MAAM,CAAC,SAAS,EAAEjF,OAAO,CAAC;IACnC;IACAkF,KAAK,CAAC,GAAGR,MAAM,IAAII,MAAM,CAACK,QAAQ,CAAC,CAAC,EAAE,CAAC,CACpCC,IAAI,CAACC,QAAQ,IAAI;MAChB,IAAI,CAACA,QAAQ,CAACC,EAAE,EACd,MAAM,IAAIC,KAAK,CAAC,sCAAsC,CAAC;MACzD,OAAOF,QAAQ,CAACG,IAAI,CAAC,CAAC;IACxB,CAAC,CAAC,CACDJ,IAAI,CAACK,IAAI,IAAI;MACZnF,YAAY,CAACmF,IAAI,CAACC,UAAU,CAAC;MAC7BlF,YAAY,CAACiF,IAAI,CAACE,UAAU,CAAC;MAC7BjF,YAAY,CAAC+E,IAAI,CAAChF,SAAS,IAAI,EAAE,CAAC;MAClCG,aAAa,CAAC6E,IAAI,CAACG,WAAW,IAAI,CAAC,CAAC,CAAC;IACvC,CAAC,CAAC,CACDC,KAAK,CAACC,KAAK,IAAIC,OAAO,CAACD,KAAK,CAAC,wCAAwC,EAAEA,KAAK,CAAC,CAAC,CAC9EE,OAAO,CAAC,MAAMlF,UAAU,CAAC,KAAK,CAAC,CAAC;EACrC,CAAC,EAAE,CAACtB,EAAE,EAAGS,SAAS,EAAED,OAAO,CAAC,CAAC;;EAE7B;EACApD,SAAS,CAAC,MAAM;IACdkE,UAAU,CAAC,IAAI,CAAC;IAChB2D,cAAc,CAAC,CAAC;EAClB,CAAC,EAAE,CAACA,cAAc,CAAC,CAAC;;EAEpB;EACA;EACF,MAAMwB,eAAe,GAAGA,CAAA,KAAM;IAC5Bf,KAAK,CAAC,GAAGP,OAAO,CAACC,GAAG,CAACC,iBAAiB,6BAA6BxE,SAAS,CAAC0E,QAAQ,EAAE,CAAC,CACrFK,IAAI,CAACc,GAAG,IAAIA,GAAG,CAACV,IAAI,CAAC,CAAC,CAAC,CACvBJ,IAAI,CAACK,IAAI,IAAI;MACZ/B,aAAa,CAAC+B,IAAI,CAAC;MACnB;MACA,MAAMU,MAAM,GAAGC,MAAM,CAACC,IAAI,CAACZ,IAAI,CAAC;MAChC,IAAIU,MAAM,CAACG,MAAM,GAAG,CAAC,IAAI,CAAC3C,YAAY,EAAE;QACtCC,eAAe,CAACuC,MAAM,CAAC,CAAC,CAAC,CAAC;MAC5B;IACF,CAAC,CAAC,CACDN,KAAK,CAACU,GAAG,IAAIR,OAAO,CAACD,KAAK,CAAC,oCAAoC,EAAES,GAAG,CAAC,CAAC;EAC3E,CAAC;;EAED;EACA,MAAMC,oBAAoB,GAAGA,CAAA,KAAM;IACjC,IAAI7C,YAAY,IAAIF,UAAU,CAACE,YAAY,CAAC,EAAE;MAC5C,MAAM8C,OAAO,GAAGhD,UAAU,CAACE,YAAY,CAAC,CAAC,CAAC;MAC1CuB,KAAK,CAAC,GAAGP,OAAO,CAACC,GAAG,CAACC,iBAAiB,SAAS,EAAE;QAC/C6B,MAAM,EAAE,KAAK;QACbC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACL,OAAO;MAC9B,CAAC,CAAC,CACCrB,IAAI,CAACc,GAAG,IAAIA,GAAG,CAACV,IAAI,CAAC,CAAC,CAAC,CACvBJ,IAAI,CAACK,IAAI,IAAI;QACZ,IAAIsB,KAAK,CAACC,OAAO,CAACvB,IAAI,CAAC,EAAE;UACvB3B,kBAAkB,CAAC2B,IAAI,CAAC;QAC1B;MACF,CAAC,CAAC,CACDI,KAAK,CAACU,GAAG,IAAIR,OAAO,CAACD,KAAK,CAAC,2CAA2C,EAAES,GAAG,CAAC,CAAC;IAClF;EACF,CAAC;EAEC3J,SAAS,CAAC,MAAM;IACd,IAAIyD,SAAS,EAAE;MACb4F,eAAe,CAAC,CAAC;IACnB;EACF,CAAC,EAAE,CAAC5F,SAAS,CAAC,CAAC;EAEfzD,SAAS,CAAC,MAAM;IACd;IACA,IAAI+G,YAAY,EAAE;MAChB6C,oBAAoB,CAAC,CAAC;IACxB;EACF,CAAC,EAAE,CAAC7C,YAAY,EAAEF,UAAU,CAAC,CAAC;EAG9B,MAAMwD,cAAc,GAAIC,UAAU,IAAK;IACrC;IACA,MAAMC,eAAe,GAAGA,CAACC,OAAO,EAAEC,IAAI,KAAK;MACzC,MAAM,CAACC,GAAG,EAAEC,KAAK,CAAC,GAAGH,OAAO,CAACI,KAAK,CAAC,GAAG,CAAC;MACvC,OAAO,GAAGH,IAAI,IAAIE,KAAK,IAAID,GAAG,EAAE;IAClC,CAAC;;IAED;IACA,MAAMD,IAAI,GAAG,IAAII,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAAC,CAAC;IACvC,MAAMC,aAAa,GAAGR,eAAe,CAACD,UAAU,CAACU,IAAI,EAAEP,IAAI,CAAC;;IAE5D;IACA;IACAnC,KAAK,CAAC,GAAGP,OAAO,CAACC,GAAG,CAACC,iBAAiB,sDAAsDxE,SAAS,CAAC0E,QAAQ,aAAa4C,aAAa,EAAE,CAAC,CACxIvC,IAAI,CAACc,GAAG,IAAIA,GAAG,CAACV,IAAI,CAAC,CAAC,CAAC,CACvBJ,IAAI,CAACK,IAAI,IAAI;MACZ,IAAIsB,KAAK,CAACC,OAAO,CAACvB,IAAI,CAAC,EAAE;QACvBrB,kBAAkB,CAACqB,IAAI,CAAC;MAC1B,CAAC,MAAM;QACLrB,kBAAkB,CAAC,EAAE,CAAC;MACxB;IACF,CAAC,CAAC,CACDyB,KAAK,CAACU,GAAG,IAAI;MACZR,OAAO,CAACD,KAAK,CAAC,uCAAuC,EAAES,GAAG,CAAC;MAC3DnC,kBAAkB,CAAC,EAAE,CAAC;IACxB,CAAC,CAAC;IAEJF,gBAAgB,CAACgD,UAAU,CAAC;IAC5BlD,gBAAgB,CAAC,IAAI,CAAC;IAEtBkB,KAAK,CAAC,GAAGP,OAAO,CAACC,GAAG,CAACC,iBAAiB,uBAAuBZ,aAAa,CAACwC,OAAO,EAAE,CAAC,CAClFrB,IAAI,CAACc,GAAG,IAAIA,GAAG,CAACV,IAAI,CAAC,CAAC,CAAC,CACvBJ,IAAI,CAACK,IAAI,IAAI;MACZM,OAAO,CAAC8B,GAAG,CAAC,uBAAuB,EAAEpC,IAAI,CAAC;MAC1CnB,gBAAgB,CAACmB,IAAI,CAAC;IACxB,CAAC,CAAC,CACDI,KAAK,CAACU,GAAG,IAAIR,OAAO,CAACD,KAAK,CAAC,wCAAwC,EAAES,GAAG,CAAC,CAAC;IAE7ErB,KAAK,CAAC,GAAGP,OAAO,CAACC,GAAG,CAACC,iBAAiB,uBAAuBZ,aAAa,CAACwC,OAAO,EAAE,CAAC,CAClFrB,IAAI,CAACc,GAAG,IAAIA,GAAG,CAACV,IAAI,CAAC,CAAC,CAAC,CACvBJ,IAAI,CAACK,IAAI,IAAI;MACZM,OAAO,CAAC8B,GAAG,CAAC,2BAA2B,EAAEpC,IAAI,CAAC;MAC9CjB,iBAAiB,CAACiB,IAAI,CAAC;IACzB,CAAC,CAAC,CACDI,KAAK,CAACU,GAAG,IAAIR,OAAO,CAACD,KAAK,CAAC,2CAA2C,EAAES,GAAG,CAAC,CAAC;EAClF,CAAC;;EAED;EACA,MAAMuB,iBAAiB,GAAGA,CAAChF,MAAM,EAAEL,KAAK,EAAEsF,QAAQ,EAAExF,QAAQ,EAAEyF,QAAQ,GAAG,IAAI,KAAK;IAChFnF,sBAAsB,CAAC;MACrBC,MAAM;MACNL,KAAK;MACLH,IAAI,EAAEyF,QAAQ,CAACzF,IAAI;MACnBC;IACF,CAAC,CAAC;IACF;IACA,IAAIyF,QAAQ,EAAE;MACZ9F,sBAAsB,CAAC8F,QAAQ,CAAC;IAClC,CAAC,MAAM,IAAIlF,MAAM,CAACmF,aAAa,IAAInF,MAAM,CAACmF,aAAa,CAACxF,KAAK,CAAC,IAAIK,MAAM,CAACmF,aAAa,CAACxF,KAAK,CAAC,CAAC6D,MAAM,GAAG,CAAC,EAAE;MACxGpE,sBAAsB,CAACY,MAAM,CAACmF,aAAa,CAACxF,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IACxD,CAAC,MAAM;MACLP,sBAAsB,CAAC,IAAI,CAAC;IAC9B;IACAS,kBAAkB,CAAC,IAAI,CAAC;EAC1B,CAAC;;EAED;EACA,MAAMuF,oBAAoB,GAAGA,CAAA,KAAM;IACjC9F,qBAAqB,CAAC;MACpBC,QAAQ,EAAEO,mBAAmB,CAACE,MAAM,CAACqF,UAAU;MAC/C7F,IAAI,EAAEM,mBAAmB,CAACN,IAAI;MAC9BC,QAAQ,EAAEK,mBAAmB,CAACL,QAAQ;MACtCC,UAAU,EAAE,GAAGI,mBAAmB,CAACE,MAAM,CAACsF,UAAU,IAAIxF,mBAAmB,CAACE,MAAM,CAACuF,gBAAgB,EAAE;MACrG5F,KAAK,EAAEG,mBAAmB,CAACH;IAC7B,CAAC,CAAC;IACFb,uBAAuB,CAAC,IAAI,CAAC;EAC/B,CAAC;;EAED;EACA,MAAM0G,qBAAqB,GAAGA,CAAA,KAAM;IAClC,IAAIrG,mBAAmB,EAAE;MACvBH,wBAAwB,CAAC,IAAI,CAAC;IAChC,CAAC,MAAM;MACLyG,KAAK,CAAC,4CAA4C,CAAC;IACrD;EACF,CAAC;;EAED;EACA,MAAMC,uBAAuB,GAAGA,CAAA,KAAM;IACpCtG,sBAAsB,CAACD,mBAAmB,CAAC;IAC3CD,0BAA0B,CAAC,IAAI,CAAC;EAClC,CAAC;;EAED;EACA,MAAMyG,iBAAiB,GAAGA,CAAC3F,MAAM,EAAEL,KAAK,EAAEH,IAAI,EAAEC,QAAQ,KAAK;IAC3DH,qBAAqB,CAAC;MACpBC,QAAQ,EAAES,MAAM,CAACqF,UAAU;MAC3B7F,IAAI;MACJC,QAAQ;MACRC,UAAU,EAAE,GAAGM,MAAM,CAACsF,UAAU,IAAItF,MAAM,CAACuF,gBAAgB,EAAE;MAC7D5F;IACF,CAAC,CAAC;IACFb,uBAAuB,CAAC,IAAI,CAAC;EAC/B,CAAC;;EAED;EACA,MAAM8G,kBAAkB,GAAGA,CAAC5F,MAAM,EAAEL,KAAK,EAAEuF,QAAQ,KAAK;IACtD,MAAMW,SAAS,GAAGlI,SAAS,CAACmI,IAAI,CAACC,EAAE,IAAIA,EAAE,CAACC,IAAI,CAACC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACxJ,EAAE,KAAKiD,KAAK,CAAC,CAAC;IACzE,MAAMwG,qBAAqB,GAAG;MAC5B5G,QAAQ,EAAES,MAAM,CAACqF,UAAU;MAC3B7F,IAAI,EAAEqG,SAAS,GAAGA,SAAS,CAACrG,IAAI,GAAG,EAAE;MACrCC,QAAQ,EAAEoG,SAAS,GAAGA,SAAS,CAACG,IAAI,GAAG,EAAE;MACzCtG,UAAU,EAAE,GAAGM,MAAM,CAACsF,UAAU,IAAItF,MAAM,CAACuF,gBAAgB,EAAE;MAC7D5F;IACF,CAAC;IACDL,qBAAqB,CAAC6G,qBAAqB,CAAC;IAC5CpG,sBAAsB,CAAC;MACrB,GAAGoG,qBAAqB;MACxBnG;IACF,CAAC,CAAC;IACFZ,sBAAsB,CAAC8F,QAAQ,CAAC;IAChClG,wBAAwB,CAAC,IAAI,CAAC;EAChC,CAAC;;EAED;EACA,MAAMoH,iBAAiB,GAAIC,UAAU,IAAK;IACxC,MAAMC,YAAY,GAAGC,kBAAkB,CAACxC,IAAI,CAACC,SAAS,CAACqC,UAAU,CAAC,CAAC;IACnEzJ,QAAQ,CAAC,UAAUW,SAAS,CAAC0E,QAAQ,UAAU9E,SAAS,YAAYmJ,YAAY,EAAE,CAAC;EACrF,CAAC;EAED,MAAME,uBAAuB,GAAItJ,OAAO,IAAK;IAC3C,MAAMoJ,YAAY,GAAGC,kBAAkB,CAACxC,IAAI,CAACC,SAAS,CAAC9G,OAAO,CAAC,CAAC;IAChEN,QAAQ,CAAC,UAAUW,SAAS,CAAC0E,QAAQ,0BAA0BqE,YAAY,EAAE,CAAC;EAChF,CAAC;;EAED;EACA,MAAMG,yBAAyB,GAAIC,cAAc,IAAK;IACpDzD,OAAO,CAAC8B,GAAG,CAAC,gCAAgC,EAAE2B,cAAc,CAAC;IAC7D;IACAlG,6BAA6B,CAAEmG,IAAI,IAAK;MACtC,IAAI,CAACtG,wBAAwB,EAAE;QAC7B,OAAO;UACLb,IAAI,EAAEkH,cAAc,CAAClH,IAAI;UACzBsF,IAAI,EAAE4B,cAAc,CAAC5B,IAAI;UACzB7C,QAAQ,EAAE1E,SAAS,CAAC0E,QAAQ;UAC5B2E,OAAO,EAAEC,MAAM,CAACH,cAAc,CAACE,OAAO,IAAI,CAAC,CAAC;UAC5CE,MAAM,EAAEJ,cAAc,CAACI;QACzB,CAAC;MACH,CAAC,MAAM;QACL,OAAO;UACLtH,IAAI,EAAEkH,cAAc,CAAClH,IAAI;UACzBsF,IAAI,EAAE4B,cAAc,CAAC5B,IAAI;UACzB7C,QAAQ,EAAE1E,SAAS,CAAC0E,QAAQ;UAC5B2E,OAAO,EAAEC,MAAM,CAACH,cAAc,CAACK,WAAW,IAAK,CAAC,CAAC;UACjDD,MAAM,EAAEJ,cAAc,CAACI;QACzB,CAAC;MACH;IACF,CAAC,CAAC;IACF;IACAxG,2BAA2B,CAAC,IAAI,CAAC;EACnC,CAAC;EAED,MAAM0G,0BAA0B,GAAGA,CAAA,KAAM;IACvC1G,2BAA2B,CAAC,KAAK,CAAC;IAClCE,6BAA6B,CAAC,CAAC,CAAC,CAAC;EACnC,CAAC;;EAGD;;EAEA;EACA,IAAIzC,OAAO,EAAE;IACX,oBACE3B,OAAA,CAACnC,SAAS;MAACgN,SAAS,EAAC,kBAAkB;MAAAC,QAAA,eACrC9K,OAAA,CAAC9B,OAAO;QAAC6M,SAAS,EAAC,QAAQ;QAACC,IAAI,EAAC,QAAQ;QAAAF,QAAA,eACvC9K,OAAA;UAAM6K,SAAS,EAAC,iBAAiB;UAAAC,QAAA,EAAC;QAAW;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC7C;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACD,CAAC;EAEhB;;EAEA;EACA,IAAI,CAACjK,SAAS,EAAE;IACd,oBAAOnB,OAAA,CAACnC,SAAS;MAAAiN,QAAA,eAAC9K,OAAA;QAAA8K,QAAA,EAAG;MAA2B;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAW,CAAC;EAClE;EAEA,oBACEpL,OAAA,CAACnC,SAAS;IAACwN,KAAK;IAAAP,QAAA,gBAEd9K,OAAA,CAAClC,GAAG;MAAC+M,SAAS,EAAC,MAAM;MAAAC,QAAA,eACnB9K,OAAA,CAACjC,GAAG;QAAC8M,SAAS,EAAC,aAAa;QAAAC,QAAA,eAC1B9K,OAAA;UAAI6K,SAAS,EAAC,WAAW;UAAAC,QAAA,GACtB3J,SAAS,CAAC0E,QAAQ,EAAC,IAAE,EAAC1E,SAAS,CAACmK,eAAe;QAAA;UAAAL,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC9C;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACF;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAGNpL,OAAA,CAAClC,GAAG;MAAC+M,SAAS,EAAC,MAAM;MAAAC,QAAA,gBACnB9K,OAAA,CAACjC,GAAG;QAACwN,EAAE,EAAE,CAAE;QAAAT,QAAA,eACT9K,OAAA,CAACzB,WAAW;UACV4C,SAAS,EAAEA,SAAU;UACrBqK,WAAW,EAAEA,CAAA,KAAM;YAAC1J,qBAAqB,CAAC,IAAI,CAAC;UAAA,CAAE;UACjD2J,SAAS,EAAEA,CAAA,KAAM;YAACzJ,mBAAmB,CAAC,IAAI,CAAC;UAAA,CAAE;UAC7C0J,QAAQ,EAAEA,CAAA,KAAM;YAACxJ,kBAAkB,CAAC,IAAI,CAAC;UAAA;QAAE;UAAA+I,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC5C;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eACNpL,OAAA,CAACjC,GAAG;QAACwN,EAAE,EAAE,CAAE;QAAAT,QAAA,eACT9K,OAAA,CAACxB,gBAAgB;UAAC2C,SAAS,EAAEA;QAAU;UAAA8J,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvC,CAAC,eACNpL,OAAA,CAACjC,GAAG;QAACwN,EAAE,EAAE,CAAE;QAAAT,QAAA,eACT9K,OAAA,CAACvB,cAAc;UACb0C,SAAS,EAAEA,SAAU;UACrBwK,gBAAgB,EAAEA,CAAA,KAAM;YAACvJ,+BAA+B,CAAC,IAAI,CAAC;UAAA,CAAE;UAChEwJ,eAAe,EAAEA,CAAA,KAAM;YAACtJ,yBAAyB,CAAC,IAAI,CAAC;UAAA,CAAE;UACzDuJ,iBAAiB,EAAEA,CAAA,KAAM;YAACrJ,iCAAiC,CAAC,IAAI,CAAC;UAAA,CAAE;UACnEsJ,SAAS,EAAEA,CAAA,KAAM,CAAC;QAAuC;UAAAb,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC1D;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAGNpL,OAAA,CAAClC,GAAG;MAAC+M,SAAS,EAAC,MAAM;MAAAC,QAAA,eACnB9K,OAAA,CAACjC,GAAG;QAAA+M,QAAA,gBACF9K,OAAA;UAAK6K,SAAS,EAAC,mDAAmD;UAAAC,QAAA,gBAEhE9K,OAAA,CAAChC,GAAG,CAACH,SAAS;YAACkO,SAAS,EAAEhL,SAAU;YAACiL,QAAQ,EAAGC,CAAC,IAAKjL,YAAY,CAACiL,CAAC,CAAE;YAAAnB,QAAA,eACpE9K,OAAA,CAAC/B,GAAG;cAACiO,OAAO,EAAC,MAAM;cAAApB,QAAA,gBACjB9K,OAAA,CAAC/B,GAAG,CAACkO,IAAI;gBAAArB,QAAA,eACP9K,OAAA,CAAC/B,GAAG,CAACI,IAAI;kBAAC+N,QAAQ,EAAC,UAAU;kBAACC,EAAE,EAAEhO,IAAK;kBAACiO,EAAE,EAAE,UAAUhM,EAAE,iBAAkB;kBAAAwK,QAAA,EAAC;gBAE3E;kBAAAG,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAU;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eACXpL,OAAA,CAAC/B,GAAG,CAACkO,IAAI;gBAAArB,QAAA,eACP9K,OAAA,CAAC/B,GAAG,CAACI,IAAI;kBAAC+N,QAAQ,EAAC,SAAS;kBAACC,EAAE,EAAEhO,IAAK;kBAACiO,EAAE,EAAE,UAAUhM,EAAE,gBAAiB;kBAAAwK,QAAA,EAAC;gBAEzE;kBAAAG,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAU;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eACXpL,OAAA,CAAC/B,GAAG,CAACkO,IAAI;gBAAArB,QAAA,eACP9K,OAAA,CAAC/B,GAAG,CAACI,IAAI;kBAAC+N,QAAQ,EAAC,SAAS;kBAACC,EAAE,EAAEhO,IAAK;kBAACiO,EAAE,EAAE,UAAUhM,EAAE,gBAAiB;kBAAAwK,QAAA,EAAC;gBAEzE;kBAAAG,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAU;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eACXpL,OAAA,CAAC/B,GAAG,CAACkO,IAAI;gBAAArB,QAAA,eACP9K,OAAA,CAAC/B,GAAG,CAACI,IAAI;kBAAC+N,QAAQ,EAAC,YAAY;kBAACC,EAAE,EAAEhO,IAAK;kBAACiO,EAAE,EAAE,UAAUhM,EAAE,mBAAoB;kBAAAwK,QAAA,EAAC;gBAE/E;kBAAAG,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAU;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eACXpL,OAAA,CAAC/B,GAAG,CAACkO,IAAI;gBAAArB,QAAA,eACP9K,OAAA,CAAC/B,GAAG,CAACI,IAAI;kBAAC+N,QAAQ,EAAC,aAAa;kBAACC,EAAE,EAAEhO,IAAK;kBAACiO,EAAE,EAAE,UAAUhM,EAAE,oBAAqB;kBAAAwK,QAAA,EAAC;gBAEjF;kBAAAG,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAU;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACR;UAAC,GA3BoE9K,EAAE;YAAA2K,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OA4B/D,CAAC,eAEhBpL,OAAA;YAAK6K,SAAS,EAAC,4BAA4B;YAAC0B,KAAK,EAAE;cAAEC,UAAU,EAAE;YAAO,CAAE;YAAA1B,QAAA,gBACxE9K,OAAA,CAACpC,MAAM;cAACiN,SAAS,EAAC,iBAAiB;cAAC4B,OAAO,EAAEA,CAAA,KAAMvL,kBAAkB,CAAC,IAAI,CAAE;cAAA4J,QAAA,gBAC1E9K,OAAA;gBAAG6K,SAAS,EAAC;cAAe;gBAAAI,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,WACnC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eACTpL,OAAA,CAACpC,MAAM;cAACiN,SAAS,EAAC,YAAY;cAACvK,EAAE,EAAC,cAAc;cAACmM,OAAO,EAAEA,CAAA,KAAM,CAAE,iCAAmC;cAAA3B,QAAA,gBACnG9K,OAAA;gBAAG6K,SAAS,EAAC;cAAoB;gBAAAI,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,mBACxC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eACNpL,OAAA,CAAChC,GAAG,CAACH,SAAS;UAACkO,SAAS,EAAEhL,SAAU;UAACiL,QAAQ,EAAGC,CAAC,IAAKjL,YAAY,CAACiL,CAAC,CAAE;UAAAnB,QAAA,eACpE9K,OAAA,CAAChC,GAAG,CAAC0O,OAAO;YAAC7B,SAAS,EAAC,MAAM;YAAAC,QAAA,gBAC3B9K,OAAA,CAAChC,GAAG,CAAC2O,IAAI;cAACP,QAAQ,EAAC,UAAU;cAAAtB,QAAA,eAC3B9K,OAAA,CAACtB,YAAY;gBAAC6H,IAAI,EAAElF;cAAU;gBAAA4J,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACzB,CAAC,eACXpL,OAAA,CAAChC,GAAG,CAAC2O,IAAI;cAACP,QAAQ,EAAC,SAAS;cAAAtB,QAAA,eAC1B9K,OAAA,CAACnB,qBAAqB;gBACpB0H,IAAI,EAAElF,SAAU;gBAChBuL,QAAQ,EAAEzL,SAAS,CAAC0L,GAAI;gBACxBC,gBAAgB,EAAG9E,UAAU,IAAK;kBAChClE,iBAAiB,CAAC,IAAI,CAAC;kBACvBE,mBAAmB,CAACgE,UAAU,CAAC;gBACjC;cAAE;gBAAAiD,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACM,CAAC,eACXpL,OAAA,CAAChC,GAAG,CAAC2O,IAAI;cAACP,QAAQ,EAAC,SAAS;cAAAtB,QAAA,gBAC1B9K,OAAA,CAAClC,GAAG;gBAAC+M,SAAS,EAAC,MAAM;gBAAAC,QAAA,eACnB9K,OAAA,CAACjC,GAAG;kBAAA+M,QAAA,eACF9K,OAAA,CAACd,WAAW;oBACV+H,MAAM,EAAEC,MAAM,CAACC,IAAI,CAAC5C,UAAU,CAAE;oBAChCE,YAAY,EAAEA,YAAa;oBAC3BsI,YAAY,EAAErI;kBAAgB;oBAAAuG,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAC/B;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACC;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eAENpL,OAAA,CAAClC,GAAG;gBAAAgN,QAAA,eACF9K,OAAA,CAACjC,GAAG;kBAAA+M,QAAA,eACF9K,OAAA,CAACf,UAAU;oBACT0F,eAAe,EAAEA,eAAgB;oBACjCmI,gBAAgB,EAAE/E;kBAAe;oBAAAkD,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAClC;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACC;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC,eACXpL,OAAA,CAAChC,GAAG,CAAC2O,IAAI;cAACP,QAAQ,EAAC,YAAY;cAAAtB,QAAA,eAC7B9K,OAAA,CAACrB,gBAAgB;gBACf4H,IAAI,EAAElF,SAAU;gBAChBE,SAAS,EAAEA,SAAU;gBACrByL,OAAO,EAAE1M,EAAG;gBACZ2M,WAAW,EAAE1E,IAAI,CAAC2E,GAAG,CAAC,CAAE;gBACxBC,aAAa,EAAE5D,iBAAkB;gBACjC6D,cAAc,EAAE5D,kBAAmB;gBACnC6D,aAAa,EAAEzE;cAAkB;gBAAAqC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAClC;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACM,CAAC,eACXpL,OAAA,CAAChC,GAAG,CAAC2O,IAAI;cAACP,QAAQ,EAAC,aAAa;cAAAtB,QAAA,eAC9B9K,OAAA;gBAAA8K,QAAA,EAAG;cAA6C;gBAAAG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC5C,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACA;QAAC,GAjD4D9K,EAAE;UAAA2K,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAkD/D,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACb;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAGNpL,OAAA,CAACX,cAAc;MACbiO,IAAI,EAAEzL,kBAAmB;MACzB0L,MAAM,EAAEA,CAAA,KAAMzL,qBAAqB,CAAC,KAAK,CAAE;MAC3CX,SAAS,EAAEA,SAAU;MACrBqM,cAAc,EAAGC,QAAQ,IAAK;QAC5BrM,YAAY,CAAC;UAAE,GAAGD,SAAS;UAAEuM,UAAU,EAAED,QAAQ,CAACE;QAAK,CAAC,CAAC;MAC3D;IAAE;MAAA1C,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eACFpL,OAAA,CAACV,YAAY;MACXgO,IAAI,EAAEvL,gBAAiB;MACvBwL,MAAM,EAAEA,CAAA,KAAMvL,mBAAmB,CAAC,KAAK,CAAE;MACzCb,SAAS,EAAEA,SAAU;MACrByM,YAAY,EAAGC,UAAU,IAAK;QAC5BzM,YAAY,CAAC;UACX,GAAGD,SAAS;UACZ2M,WAAW,EAAED,UAAU,CAACE,YAAY;UACpCC,QAAQ,EAAEH,UAAU,CAACG;QACvB,CAAC,CAAC;QACFzI,cAAc,CAAC,CAAC;MAClB;IAAE;MAAA0F,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eACFpL,OAAA,CAACT,WAAW;MACV+N,IAAI,EAAErL,eAAgB;MACtBsL,MAAM,EAAEA,CAAA,KAAMrL,kBAAkB,CAAC,KAAK,CAAE;MACxCf,SAAS,EAAEA,SAAU;MACrB8M,WAAW,EAAGC,KAAK,IAAK;QACtB9M,YAAY,CAAC;UAAE,GAAGD,SAAS;UAAEgN,EAAE,EAAED;QAAM,CAAC,CAAC;MAC3C;IAAE;MAAAjD,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eACFpL,OAAA,CAACR,wBAAwB;MACvB8N,IAAI,EAAEnL,4BAA6B;MACnCoL,MAAM,EAAEA,CAAA,KAAMnL,+BAA+B,CAAC,KAAK,CAAE;MACrDjB,SAAS,EAAEA,SAAU;MACrBiN,mBAAmB,EAAGC,iBAAiB,IAAK;QAC1CjN,YAAY,CAAC;UACX,GAAGD,SAAS;UACZmN,aAAa,EAAED,iBAAiB,CAAC/N,EAAE;UACnCiO,gBAAgB,EAAEF,iBAAiB,CAACV;QACtC,CAAC,CAAC;MACJ;IAAE;MAAA1C,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eACFpL,OAAA,CAACP,kBAAkB;MACjB6N,IAAI,EAAEjL,sBAAuB;MAC7BkL,MAAM,EAAEA,CAAA,KAAMjL,yBAAyB,CAAC,KAAK,CAAE;MAC/CnB,SAAS,EAAEA,SAAU;MACrBqN,kBAAkB,EAAGC,gBAAgB,IAAK;QACxCrN,YAAY,CAAC;UACX,GAAGD,SAAS;UACZuN,YAAY,EAAED,gBAAgB,CAACnO,EAAE;UACjCqO,gBAAgB,EAAEF,gBAAgB,CAACd;QACrC,CAAC,CAAC;MACJ;IAAE;MAAA1C,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eACFpL,OAAA,CAACN,0BAA0B;MACzB4N,IAAI,EAAE/K,8BAA+B;MACrCgL,MAAM,EAAEA,CAAA,KAAM/K,iCAAiC,CAAC,KAAK,CAAE;MACvDrB,SAAS,EAAEA,SAAU;MACrByN,oBAAoB,EAAGC,kBAAkB,IAAK;QAC5CzN,YAAY,CAAC;UAAE,GAAGD,SAAS;UAAE2N,qBAAqB,EAAED,kBAAkB,CAAClB;QAAK,CAAC,CAAC;MAChF;IAAE;MAAA1C,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAEFpL,OAAA,CAACL,gBAAgB;MACf2N,IAAI,EAAE7K,oBAAqB;MAC3B8K,MAAM,EAAEA,CAAA,KAAM7K,uBAAuB,CAAC,KAAK,CAAE;MAC7CS,QAAQ,EAAEF,kBAAkB,CAACE,QAAS;MACtC4L,OAAO,EAAE5N,SAAS,CAAC0E,QAAS;MAC5BzC,IAAI,EAAEH,kBAAkB,CAACG,IAAK;MAC9BC,QAAQ,EAAEJ,kBAAkB,CAACI,QAAS;MACtCC,UAAU,EAAEL,kBAAkB,CAACK,UAAW;MAC1C0L,eAAe,EAAGzI,IAAI,IAAK;QACzBhB,cAAc,CAAC,CAAC;MAClB,CAAE;MACF0J,SAAS,EAAExN,UAAU,CAACwB,kBAAkB,CAACE,QAAQ;IAAE;MAAA8H,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACpD,CAAC,eACFpL,OAAA,CAACJ,iBAAiB;MAChB0N,IAAI,EAAE3K,qBAAsB;MAC5B4K,MAAM,EAAEA,CAAA,KAAM3K,wBAAwB,CAAC,KAAK,CAAE;MAC9CO,QAAQ,GAAAhD,qBAAA,GAAEuD,mBAAmB,CAACE,MAAM,cAAAzD,qBAAA,uBAA1BA,qBAAA,CAA4B8I,UAAW;MACjD8F,OAAO,EAAE5N,SAAS,CAAC0E,QAAS;MAC5B9C,mBAAmB,EAAEA,mBAAoB;MACzCE,kBAAkB,EAAES,mBAAoB;MACxCwL,iBAAiB,EAAG3I,IAAI,IAAK;QAC3BhB,cAAc,CAAC,CAAC;MAClB,CAAE;MACF0J,SAAS,EAAExN,UAAU,CAACwB,kBAAkB,CAACE,QAAQ;IAAE;MAAA8H,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACpD,CAAC,eACFpL,OAAA,CAACH,mBAAmB;MAClByN,IAAI,EAAEzK,uBAAwB;MAC9B0K,MAAM,EAAEA,CAAA,KAAMzK,0BAA0B,CAAC,KAAK,CAAE;MAChDK,QAAQ,GAAA/C,sBAAA,GAAEsD,mBAAmB,CAACE,MAAM,cAAAxD,sBAAA,uBAA1BA,sBAAA,CAA4B6I,UAAW;MACjD8F,OAAO,EAAE5N,SAAS,CAAC0E,QAAS;MAC5BtC,KAAK,EAAEN,kBAAkB,CAACM,KAAM;MAChC4L,YAAY,EAAEpM,mBAAoB;MAClCqM,iBAAiB,EAAG7I,IAAI,IAAK;QAC3BhB,cAAc,CAAC,CAAC;MAClB;IAAE;MAAA0F,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eACFpL,OAAA,CAACF,WAAW;MACVwN,IAAI,EAAE9J,eAAgB;MACtB+J,MAAM,EAAEA,CAAA,KAAM9J,kBAAkB,CAAC,KAAK,CAAE;MACxCG,MAAM,GAAAvD,sBAAA,GAAEqD,mBAAmB,CAACE,MAAM,cAAAvD,sBAAA,uBAA1BA,sBAAA,CAA4B4I,UAAW;MAC/C1F,KAAK,EAAEG,mBAAmB,CAACH,KAAM;MACjCH,IAAI,EAAEM,mBAAmB,CAACN,IAAK;MAC/B2L,OAAO,EAAE5N,SAAS,CAAC0E,QAAS;MAC5BxC,QAAQ,EAAEK,mBAAmB,CAACL,QAAS;MACvCgM,KAAK,EAAErG,oBAAqB;MAC5BsG,MAAM,EAAElG,qBAAsB;MAC9BmG,QAAQ,EAAEjG;IAAwB;MAAA2B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACnC,CAAC,EACDrK,SAAS,KAAK,YAAY,iBACzBf,OAAA,CAACpB,oBAAoB;MACnB0O,IAAI,EAAErM,eAAgB;MACtBsM,MAAM,EAAEA,CAAA,KAAMrM,kBAAkB,CAAC,KAAK,CAAE;MACxC8L,OAAO,EAAE7L,SAAS,CAAC0E,QAAS;MAC5B2J,aAAa,EAAEzO,SAAU;MACzB0O,gBAAgB,EAAG3O,OAAO,IAAK;QAC7B,MAAMoJ,YAAY,GAAGC,kBAAkB,CAACxC,IAAI,CAACC,SAAS,CAAC9G,OAAO,CAAC,CAAC;QAChEN,QAAQ,CAAC,UAAUW,SAAS,CAAC0E,QAAQ,UAAU9E,SAAS,YAAYmJ,YAAY,EAAE,CAAC;MACrF;IAAE;MAAAe,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAEF,EACArK,SAAS,KAAK,SAAS,iBACtBf,OAAA,CAAChB,gBAAgB;MACfsO,IAAI,EAAErM,eAAgB;MACtB+L,OAAO,EAAE7L,SAAS,CAAC0E,QAAS;MAC5B0H,MAAM,EAAEA,CAAA,KAAMrM,kBAAkB,CAAC,KAAK,CAAE;MACxCwO,cAAc,EAAG5O,OAAO,IAAK;QAC3B,MAAMoJ,YAAY,GAAGC,kBAAkB,CAACxC,IAAI,CAACC,SAAS,CAAC9G,OAAO,CAAC,CAAC;QAChEN,QAAQ,CAAC,UAAUW,SAAS,CAAC0E,QAAQ,UAAU9E,SAAS,YAAYmJ,YAAY,EAAE,CAAC;MACrF;IAAE;MAAAe,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACF,EACArK,SAAS,KAAK,SAAS,iBACtBf,OAAA,CAACZ,eAAe;MACdkO,IAAI,EAAErM,eAAgB;MACtBsM,MAAM,EAAEA,CAAA,KAAMrM,kBAAkB,CAAC,KAAK,CAAE;MACxCwO,cAAc,EAAG5O,OAAO,IAAK;QAC3B,MAAMoJ,YAAY,GAAGC,kBAAkB,CAACxC,IAAI,CAACC,SAAS,CAAC9G,OAAO,CAAC,CAAC;QAChEN,QAAQ,CAAC,UAAUW,SAAS,CAAC0E,QAAQ,0BAA0BqE,YAAY,EAAE,CAAC;MAChF,CAAE;MACFjF,eAAe,EAAEA,eAAgB;MACjC0K,eAAe,EAAExK,aAAc;MAC/ByK,kBAAkB,EAAEvK;IAAe;MAAA4F,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACpC,CACF,eAEDpL,OAAA,CAAClB,UAAU;MACTwO,IAAI,EAAEzJ,cAAe;MACrB0J,MAAM,EAAEA,CAAA,KAAMzJ,iBAAiB,CAAC,KAAK,CAAE;MACvC+L,WAAW,EAAE9L,gBAAgB,IAAI,CAAC,CAAE;MACpC6I,QAAQ,EAAEzL,SAAS,CAAC0L,GAAI;MACxBiD,MAAM,EAAGC,OAAO,IAAK;QACnB,OAAO/J,KAAK,CAAC,GAAGP,OAAO,CAACC,GAAG,CAACC,iBAAiB,8CAA8C,EAAE;UAC3F6B,MAAM,EAAEzD,gBAAgB,aAAhBA,gBAAgB,eAAhBA,gBAAgB,CAAEiM,aAAa,GAAG,KAAK,GAAG,MAAM;UACxDvI,OAAO,EAAE;YAAE,cAAc,EAAE;UAAmB,CAAC;UAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACmI,OAAO;QAC9B,CAAC,CAAC,CACC7J,IAAI,CAAC,MAAOC,QAAQ,IAAK;UACxB,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;YAChB,MAAM6J,SAAS,GAAG,MAAM9J,QAAQ,CAACG,IAAI,CAAC,CAAC;YACvC;YACA,MAAM2J,SAAS;UACjB;UACA,OAAO9J,QAAQ,CAACG,IAAI,CAAC,CAAC;QACxB,CAAC,CAAC,CACDJ,IAAI,CAAEK,IAAI,IAAK;UACd,IAAIA,IAAI,CAAC2J,MAAM,KAAK,SAAS,EAAE;YAC7B3K,cAAc,CAAC,CAAC,CAAC,CAAC;UACpB;UACA,OAAOgB,IAAI;QACb,CAAC,CAAC;MACN,CAAE;MACF4J,YAAY,EAAE9F;IAA0B;MAAAY,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACzC,CAAC,eAEFpL,OAAA,CAACjB,oBAAoB;MACnBuO,IAAI,EAAErJ,wBAAyB;MAC/BsJ,MAAM,EAAEA,CAAA,KAAM;QACZrJ,2BAA2B,CAAC,KAAK,CAAC;QAClCE,6BAA6B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACrC,CAAE;MACFyL,WAAW,EAAE1L,0BAA2B;MACxCyI,QAAQ,EAAEzL,SAAS,CAAC0L,GAAI;MACxBuD,gBAAgB,EAAEjM,0BAA0B,CAACqG,OAAO,IAAI,CAAE;MAC1DsF,MAAM,EAAGC,OAAO,IAAK;QACnB;QACA/J,KAAK,CAAC,GAAGP,OAAO,CAACC,GAAG,CAACC,iBAAiB,0CAA0C,EAAE;UAChF6B,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YAAE,cAAc,EAAE;UAAmB,CAAC;UAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACmI,OAAO;QAC9B,CAAC,CAAC,CACC7J,IAAI,CAACmK,CAAC,IAAIA,CAAC,CAAC/J,IAAI,CAAC,CAAC,CAAC,CACnBJ,IAAI,CAACK,IAAI,IAAI;UACZ,IAAIA,IAAI,CAAC2J,MAAM,KAAK,SAAS,EAAE;YAC7B3K,cAAc,CAAC,CAAC;UAClB,CAAC,MAAM;YACL8D,KAAK,CAAC,+BAA+B,GAAG9C,IAAI,CAAC+J,OAAO,CAAC;UACvD;UACA,OAAO/J,IAAI;QACb,CAAC,CAAC,CACDI,KAAK,CAACC,KAAK,IAAI;UACdC,OAAO,CAACD,KAAK,CAAC,QAAQ,EAAEA,KAAK,CAAC;UAC9ByC,KAAK,CAAC,iCAAiC,CAAC;QAC1C,CAAC,CAAC;MACN,CAAE;MACF8G,YAAY,EAAE9F;IAA0B;MAAAY,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAEzC,CAAC,eACFpL,OAAA,CAACb,mBAAmB;MAClBmO,IAAI,EAAEzI,aAAc;MACpB0I,MAAM,EAAEA,CAAA,KAAMzI,gBAAgB,CAAC,KAAK,CAAE;MACtC+K,WAAW,EAAE9K,aAAa,IAAI,CAAC,CAAE;MACjC+K,MAAM,EAAGC,OAAO,IAAK;QACnB;QACA,OAAO/J,KAAK,CAAC,GAAGP,OAAO,CAACC,GAAG,CAACC,iBAAiB,iCAAiC,EAAE;UAC9E6B,MAAM,EAAEzC,aAAa,aAAbA,aAAa,eAAbA,aAAa,CAAEzE,EAAE,GAAG,KAAK,GAAG,MAAM;UAC1CmH,OAAO,EAAE;YAAE,cAAc,EAAE;UAAmB,CAAC;UAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACmI,OAAO;QAC9B,CAAC,CAAC,CACC7J,IAAI,CAACc,GAAG,IAAIA,GAAG,CAACV,IAAI,CAAC,CAAC,CAAC,CACvBJ,IAAI,CAACK,IAAI,IAAI;UACZ,IAAIA,IAAI,CAAC2J,MAAM,KAAK,SAAS,EAAE;YAC7B5I,oBAAoB,CAAC,CAAC,CAAC,CAAC;YACxB,OAAOf,IAAI;UACb,CAAC,MAAM,IAAGA,IAAI,CAACgK,WAAW,KAAK,GAAG,EAAE;YAClC,MAAM,IAAIlK,KAAK,CAACE,IAAI,CAACiK,MAAM,IAAI,gCAAgC,CAAC;UAClE,CAAC,MAAM;YACL,MAAM,IAAInK,KAAK,CAACE,IAAI,CAAC+J,OAAO,IAAI,gCAAgC,CAAC;UACnE;QACF,CAAC,CAAC;MACN,CAAE;MACFrL,eAAe,EAAEA;IAAgB;MAAAgG,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAClC,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACO,CAAC;AAEhB,CAAC;AAAClL,EAAA,CAvsBID,WAAW;EAAA,QACA9B,SAAS,EACPC,WAAW,EACXE,WAAW;AAAA;AAAAmS,EAAA,GAHxBxQ,WAAW;AAysBjB,eAAeA,WAAW;AAAC,IAAAwQ,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}